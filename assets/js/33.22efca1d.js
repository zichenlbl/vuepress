(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{509:function(s,n,t){"use strict";t.r(n);var a=t(10),e=Object(a.a)({},(function(){var s=this,n=s._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h3",{attrs:{id:"未分类"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#未分类"}},[s._v("#")]),s._v(" 未分类")]),s._v(" "),n("div",{staticClass:"language-csharp line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-csharp"}},[n("code",[n("span",{pre:!0,attrs:{class:"token preprocessor property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("region")]),s._v(" 注释 根据进程名称发送")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//按进程名称查找，同名称的进程可能有许多，所以返回的是一个数组")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//System.Diagnostics.Process[] foundProcess = System.Diagnostics.Process.GetProcessesByName("icn_sr");')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//foreach (System.Diagnostics.Process p in foundProcess)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    int toWindowHandler = p.MainWindowHandle.ToInt32();")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    if (toWindowHandler != 0)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        Form1.CopyDataStruct cds;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        cds.dwData = (IntPtr)1;   //这里可以传入一些自定义的数据，但只能是4字节整数      ")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        cds.lpData = mArguments;            //消息字符串")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        cds.cbData = System.Text.Encoding.Default.GetBytes(mArguments).Length + 1;  //注意，这里的长度是按字节来算的")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        //发送方的窗口的句柄, 由于本系统中的接收方不关心是该消息是从哪个窗口发出的，所以就直接填0了")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        int fromWindowHandler = 0;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        Form1.SendMessage(toWindowHandler, Form1.WM_COPYDATA, fromWindowHandler, ref cds);")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token preprocessor property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endregion")]),s._v(" 根据进程名称发送")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br")])]),n("p",[s._v("编辑模板")]),s._v(" "),n("div",{staticClass:"language-csharp line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-csharp"}},[n("code",[s._v("\n"),n("span",{pre:!0,attrs:{class:"token preprocessor property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("region")]),s._v(" gridview大列表")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 获取选中行的参数")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//int mSelectRow = gridView1.GetSelectedRows()[0];")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//string mIid = this.gridView1.GetRowCellValue(mSelectRow, "iid").ToString();')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//string mTemplateName = this.gridView1.GetRowCellValue(mSelectRow, "结构化模板名称").ToString();')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//string mSysType = this.gridView1.GetRowCellValue(mSelectRow, "系统类型").ToString();')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//string mGroupLab = this.gridView1.GetRowCellValue(mSelectRow, "分组标签").ToString();')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//string mInstitutionCode = this.gridView1.GetRowCellValue(mSelectRow, "院区编码").ToString();')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//string mTemplateVer = this.gridView1.GetRowCellValue(mSelectRow, "版本号").ToString();')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//string mCreateUsercode = this.gridView1.GetRowCellValue(mSelectRow, "创建者编码").ToString();')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//string mCreateUsername = this.gridView1.GetRowCellValue(mSelectRow, "创建者姓名").ToString();')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//string mUpdateUsercode = "icn1";')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//string mUpdateUsername = "icn1";')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('////string m = this.gridView1.GetRowCellValue(mSelectRow, "创建时间").ToString();')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('////string m = this.gridView1.GetRowCellValue(mSelectRow, "更新时间").ToString();')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('////string m = this.gridView1.GetRowCellValue(mSelectRow, "数据状态").ToString();')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token preprocessor property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endregion")]),s._v(" gridview大列表")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br")])]),n("p",[s._v("icn_sr模板初始化事件")]),s._v(" "),n("div",{staticClass:"language-csharp line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-csharp"}},[n("code",[n("span",{pre:!0,attrs:{class:"token preprocessor property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("region")]),s._v(" 注释 调用js方法传递模板参数")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//var mT1 = new Thread(() =>")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    int mTimes = 0; //执行时间")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    //模板没有加载成功 并且加载时间小于10秒")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    while (mTimes < 10)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//        //MessageBox.Show("loading");')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        string mDataTemplatParameter = Encoding.Default.GetString(Convert.FromBase64String(S_Args[1]));")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        try")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//            uc_sring1.chromeBrowser.ExecuteScriptAsync("getUserInof(\'" + mDataTemplatParameter + "\');");')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        catch (Exception)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        Thread.Sleep(1000);")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        mTimes++;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//});")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//mT1.IsBackground = true;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//mT1.Start();")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token preprocessor property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endregion")]),s._v(" 注释")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br")])]),n("p",[s._v("写报告页面")]),s._v(" "),n("p",[s._v("加载事件")]),s._v(" "),n("div",{staticClass:"language-csharp line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-csharp"}},[n("code",[s._v("\n"),n("span",{pre:!0,attrs:{class:"token preprocessor property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("region")]),s._v(" 注释 打开报告做的一些事情")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//打开报告加载模板")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//new Thread(() =>")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    int mTimes = 0; //执行时间")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    while (!EditorStatus.G_TemplateLoadingStatus && mTimes < 10)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        #region 打开报告")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        PostgreSQLContext context = new PostgreSQLContext(new PostgreSQLConnectionFactory(DBConnectionString.POSTGRE_SQL));")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        try")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            //判断新增报告还是修改报告")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            if (S_Args != null)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                string mParameter = Encoding.Default.GetString(Convert.FromBase64String(S_Args[1]));")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                JObject mJobject = JObject.Parse(mParameter);")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                long mExamIid = Convert.ToInt64(mJobject["exam_iid"]);')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                // 根据检查表iid查询是否有报告")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                var mGetExamReport = context.Query<sr_exam_report>().Where(a => a.exam_iid == mExamIid && a.flag == "9")')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    .Select(a => new { a.sr_data }).FirstOrDefault();")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                if (mGetExamReport == null)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    // 新增，打开对应的模板")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                    long mTemplatIid = Convert.ToInt64(mJobject["sr_templat_iid"]);')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    var m_q_datatemplat = context.Query<sr_data_templat>();")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    var mGetDataTemplate = m_q_datatemplat.Where(a => a.iid == mTemplatIid)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                        .Select(a => new")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                        {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                            a.template_data")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                        }).FirstOrDefault();")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    if (!string.IsNullOrEmpty(mGetDataTemplate.template_data))")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                        //EditorStatus.G_PatientInformationUpdateStatus = false; //设置病人信息回写为未完成")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                        uc_sring1.chromeBrowser.ExecuteScriptAsync("f_load_template(\'" + mGetDataTemplate.template_data + "\');");')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                        //EditorStatus.G_TemplateLoadingStatus = true; //设置模板状态为加载")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                else")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                    //MessageBox.Show("打开报告");')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    // 修改，打开旧报告")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    if (!string.IsNullOrEmpty(mGetExamReport.sr_data))")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                        //EditorStatus.G_TemplateLoadingStatus = true; //设置模板状态为加载完成")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                        EditorStatus.G_PatientInformationUpdateStatus = true; //设置病人信息回写为完成")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                        uc_sring1.chromeBrowser.ExecuteScriptAsync("f_load_template(\'" + mGetExamReport.sr_data + "\');");')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                //EditorStatus.G_TemplateLoadingStatus = true; //设置模板状态为加载完成")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        catch (Exception ex)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//            LogManager.WriteLog("打开报告出错：" + ex.Message);')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        finally")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            context.Dispose();")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        #endregion 打开报告")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        Thread.Sleep(1000);")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        mTimes++;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    }")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}).Start();")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("////判断模板加载好，并进行回写报告")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//new Thread(() =>")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    int mWriteBackTimes = 0; //回写时间")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    while (mWriteBackTimes < 9)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        //模板加载好，回写没有好，进行回写")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        if (EditorStatus.G_TemplateLoadingStatus &&")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            mWriteBackTimes < 10 && !EditorStatus.G_PatientInformationUpdateStatus)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//            //MessageBox.Show("模板加载完成！", "提示", MessageBoxButtons.OK, MessageBoxIcon.Information, MessageBoxDefaultButton.Button1, MessageBoxOptions.DefaultDesktopOnly);')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            #region 回写病人信息")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            string mPatientInformation = Encoding.Default.GetString(Convert.FromBase64String(S_Args[2]));")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//            uc_sring1.chromeBrowser.ExecuteScriptAsync("f_set_data(\'" + mPatientInformation + "\');");')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            #endregion 回写病人信息")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            Thread.Sleep(1000);")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            mWriteBackTimes++;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        //模板  加载好，回写了5秒还没好")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        else if (EditorStatus.G_TemplateLoadingStatus &&")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            mWriteBackTimes > 9 && !EditorStatus.G_PatientInformationUpdateStatus)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//            MessageBox.Show("回写失败");')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            break;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        //模板没加载好，加载了5秒还没好")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        else if (!EditorStatus.G_TemplateLoadingStatus &&")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            mWriteBackTimes > 9)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {//回写了5秒后还没返回True，提示")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//            MessageBox.Show("模板加载失败！", "提示", MessageBoxButtons.OK, MessageBoxIcon.Information, MessageBoxDefaultButton.Button1, MessageBoxOptions.DefaultDesktopOnly);')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            break;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        else")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            Thread.Sleep(1000);")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            mWriteBackTimes++;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    }")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}).Start();")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("////只判断病人信息是否回写完成")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//new Thread(() =>")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    int mWriteBackTimes = 0; //回写时间")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    while (true)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        if (EditorStatus.G_PatientInformationUpdateStatus && ")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            mWriteBackTimes < 10)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//            //MessageBox.Show("回写完成！", "回写提示", MessageBoxButtons.OK, MessageBoxIcon.Information, MessageBoxDefaultButton.Button1, MessageBoxOptions.DefaultDesktopOnly);')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            break;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        else if (!EditorStatus.G_PatientInformationUpdateStatus && ")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            mWriteBackTimes > 9)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {//回写了5秒后还没返回True，提示回写失败")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//            MessageBox.Show("回写失败！", "回写提示", MessageBoxButtons.OK, MessageBoxIcon.Information, MessageBoxDefaultButton.Button1, MessageBoxOptions.DefaultDesktopOnly);')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            break;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        else")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            Thread.Sleep(1000);")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            mWriteBackTimes++;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}).Start();")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token preprocessor property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endregion")]),s._v(" 打开报告做的一些事情")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br"),n("span",{staticClass:"line-number"},[s._v("93")]),n("br"),n("span",{staticClass:"line-number"},[s._v("94")]),n("br"),n("span",{staticClass:"line-number"},[s._v("95")]),n("br"),n("span",{staticClass:"line-number"},[s._v("96")]),n("br"),n("span",{staticClass:"line-number"},[s._v("97")]),n("br"),n("span",{staticClass:"line-number"},[s._v("98")]),n("br"),n("span",{staticClass:"line-number"},[s._v("99")]),n("br"),n("span",{staticClass:"line-number"},[s._v("100")]),n("br"),n("span",{staticClass:"line-number"},[s._v("101")]),n("br"),n("span",{staticClass:"line-number"},[s._v("102")]),n("br"),n("span",{staticClass:"line-number"},[s._v("103")]),n("br"),n("span",{staticClass:"line-number"},[s._v("104")]),n("br"),n("span",{staticClass:"line-number"},[s._v("105")]),n("br"),n("span",{staticClass:"line-number"},[s._v("106")]),n("br"),n("span",{staticClass:"line-number"},[s._v("107")]),n("br"),n("span",{staticClass:"line-number"},[s._v("108")]),n("br"),n("span",{staticClass:"line-number"},[s._v("109")]),n("br"),n("span",{staticClass:"line-number"},[s._v("110")]),n("br"),n("span",{staticClass:"line-number"},[s._v("111")]),n("br"),n("span",{staticClass:"line-number"},[s._v("112")]),n("br"),n("span",{staticClass:"line-number"},[s._v("113")]),n("br"),n("span",{staticClass:"line-number"},[s._v("114")]),n("br"),n("span",{staticClass:"line-number"},[s._v("115")]),n("br"),n("span",{staticClass:"line-number"},[s._v("116")]),n("br"),n("span",{staticClass:"line-number"},[s._v("117")]),n("br"),n("span",{staticClass:"line-number"},[s._v("118")]),n("br"),n("span",{staticClass:"line-number"},[s._v("119")]),n("br"),n("span",{staticClass:"line-number"},[s._v("120")]),n("br"),n("span",{staticClass:"line-number"},[s._v("121")]),n("br"),n("span",{staticClass:"line-number"},[s._v("122")]),n("br"),n("span",{staticClass:"line-number"},[s._v("123")]),n("br"),n("span",{staticClass:"line-number"},[s._v("124")]),n("br"),n("span",{staticClass:"line-number"},[s._v("125")]),n("br"),n("span",{staticClass:"line-number"},[s._v("126")]),n("br"),n("span",{staticClass:"line-number"},[s._v("127")]),n("br"),n("span",{staticClass:"line-number"},[s._v("128")]),n("br"),n("span",{staticClass:"line-number"},[s._v("129")]),n("br"),n("span",{staticClass:"line-number"},[s._v("130")]),n("br"),n("span",{staticClass:"line-number"},[s._v("131")]),n("br"),n("span",{staticClass:"line-number"},[s._v("132")]),n("br"),n("span",{staticClass:"line-number"},[s._v("133")]),n("br"),n("span",{staticClass:"line-number"},[s._v("134")]),n("br"),n("span",{staticClass:"line-number"},[s._v("135")]),n("br")])]),n("p",[s._v("结构化报告保存")]),s._v(" "),n("div",{staticClass:"language-csharp line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-csharp"}},[n("code",[n("span",{pre:!0,attrs:{class:"token preprocessor property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("region")]),s._v(" 注释")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/// 测试代码")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//S_TemplateIid = 106;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//var mGetDataTemplat = context.Query<sr_data_templat>().Where(a => a.iid == S_TemplateIid)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    .Select(a => new { a.opinion, a.conclusion }).FirstOrDefault();")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("////获取所见和结论要拼接的内容")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//JavascriptResponse mOpinionJavascriptResponse = await uc_sring1.chromeBrowser.EvaluateScriptAsync("setDatas", mGetDataTemplat.opinion);')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//if (mOpinionJavascriptResponse.Success)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    string mResult = mOpinionJavascriptResponse.Result.ToString();")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    mResult = mResult.Substring(0, mResult.Length - 1);")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    //MessageBox.Show(mResult);")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//else")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    //MessageBox.Show(mOpinionJavascriptResponse.Message);")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//JavascriptResponse mConclusionJavascriptResponse = await uc_sring1.chromeBrowser.EvaluateScriptAsync("setDatas", mGetDataTemplat.conclusion);')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//if (mConclusionJavascriptResponse.Success)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    string mResult = mConclusionJavascriptResponse.Result.ToString();")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    mResult = mResult.Substring(0, mResult.Length - 1);")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    //MessageBox.Show(mResult);")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//else")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    //MessageBox.Show(mConclusionJavascriptResponse.Message);")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//return;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/// 测试代码")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token preprocessor property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endregion")]),s._v(" 注释")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br")])]),n("p",[s._v("保存报告")]),s._v(" "),n("div",{staticClass:"language-csharp line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-csharp"}},[n("code",[s._v("\n"),n("span",{pre:!0,attrs:{class:"token preprocessor property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("region")]),s._v(" 注释 根据进程名称发送")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("////按进程名称查找，同名称的进程可能有许多，所以返回的是一个数组")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//System.Diagnostics.Process[] foundProcess = System.Diagnostics.Process.GetProcessesByName("cnris");')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//foreach (System.Diagnostics.Process p in foundProcess)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    int toWindowHandler = p.MainWindowHandle.ToInt32();")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    if (toWindowHandler != 0)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        Form1.CopyDataStruct cds;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        cds.dwData = (IntPtr)1;   //这里可以传入一些自定义的数据，但只能是4字节整数      ")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//        string mLpDataStr = "icn_sr_save";//第一个参数 通知cnris保存报告,第二个参数所见,第三个参数结论')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        if (!string.IsNullOrEmpty(mOpinionStr))")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//            mLpDataStr += " " + mOpinionStr;')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        if (!string.IsNullOrEmpty(mConclusionStr))")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//            mLpDataStr += " " + mConclusionStr;')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//        MessageBox.Show("发送的参数:" + mLpDataStr);')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        cds.lpData = mLpDataStr;            //消息字符串")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        cds.cbData = System.Text.Encoding.Default.GetBytes(mLpDataStr).Length + 1;  //注意，这里的长度是按字节来算的")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        //发送方的窗口的句柄, 由于本系统中的接收方不关心是该消息是从哪个窗口发出的，所以就直接填0了")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        int fromWindowHandler = 0;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        Form1.SendMessage(toWindowHandler, Form1.WM_COPYDATA, fromWindowHandler, ref cds);")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token preprocessor property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endregion")]),s._v(" 根据进程名称发送")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br")])]),n("div",{staticClass:"language-csharp line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-csharp"}},[n("code",[s._v("\n"),n("span",{pre:!0,attrs:{class:"token preprocessor property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("region")]),s._v(" 注释 根据标题名称发送")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("////将文本框中的值， 发送给接收端           ")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//CopyDataStruct cds1;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//cds1.dwData = (IntPtr)1; //这里可以传入一些自定义的数据，但只能是4字节整数")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//string mLpDataStr = "icn_sr_save";//第一个参数 通知cnris保存报告,第二个参数所见,第三个参数结论')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//if (!string.IsNullOrEmpty(mOpinionStr))")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//    mLpDataStr += " " + mOpinionStr;')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//if (!string.IsNullOrEmpty(mConclusionStr))")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//    mLpDataStr += " " + mConclusionStr;')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//mLpDataStr += " " + mReport.exam_iid;')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//cds1.lpData = mLpDataStr;            //消息字符串")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//cds1.cbData = System.Text.Encoding.Default.GetBytes(mLpDataStr).Length + 1;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("////注意，这里的长度是按字节来算的")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//int b = FindWindow(null, "放射报告书写");')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//SendMessage(b, WM_COPYDATA, 0, ref cds1);")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//// 这里要修改成接收窗口的标题“接收端”")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token preprocessor property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endregion")])]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br")])]),n("p",[s._v("打开报告做的一些事")]),s._v(" "),n("div",{staticClass:"language-csharp line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-csharp"}},[n("code",[s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/// <summary>")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/// 打开报告时做的一些事情")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/// </summary>")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token return-type class-name"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("f_OpenReport")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//try")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    //每次加载报告时都设置 模板加载状态为未加载，病人信息回写状态为未回写")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    EditorStatus.G_TemplateLoadingStatus = false;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    EditorStatus.G_PatientInformationUpdateStatus = false;")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    int mLoadMode = 0; //加载模式，0：新增报告 1:修改报告")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    //1.打开报告加载模板")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    var mT1 = new Thread(() =>")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        int mTimes = 0; //执行时间")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                        //模板没有加载成功 并且加载时间小于10秒")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        while (!EditorStatus.G_TemplateLoadingStatus && mTimes < 10)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            #region 打开报告")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            PostgreSQLContext context = new PostgreSQLContext(new PostgreSQLConnectionFactory(DBConnectionString.POSTGRE_SQL));")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            try")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                //判断新增报告还是修改报告")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                if (S_Args != null)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    string mParameter = Encoding.Default.GetString(Convert.FromBase64String(S_Args[1]));")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    //解析参数")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    SaveEventParameter mSaveEventReportParameter = new JavaScriptSerializer()")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                         .Deserialize<SaveEventParameter>(mParameter);")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    ExamReportParameter mReport = mSaveEventReportParameter.parameter;")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    //JObject mJobject = JObject.Parse(mParameter);")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    long mExamIid = mReport.exam_iid;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                    //long mExamIid = Convert.ToInt64(mJobject["exam_iid"]);')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    // 根据检查表iid查询是否有报告")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                    var mGetExamReport = context.Query<sr_exam_report>().Where(a => a.exam_iid == mExamIid && a.flag == "9")')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                        .Select(a => new { a.sr_data }).FirstOrDefault();")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    // 新增，打开对应的模板")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    if (mGetExamReport == null)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                        long mTemplatIid = mReport.sr_templat_iid;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                        //long mTemplatIid = Convert.ToInt64(mJobject["sr_templat_iid"]);')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                        var m_q_datatemplat = context.Query<sr_data_templat>();")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                        var mGetDataTemplate = m_q_datatemplat.Where(a => a.iid == mTemplatIid)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                            .Select(a => new")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                            {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                                a.template_data")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                            }).FirstOrDefault();")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                        //加载模板")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                        if (!string.IsNullOrEmpty(mGetDataTemplate.template_data))")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                        {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                            uc_sring1.chromeBrowser.ExecuteScriptAsync("f_load_template(\'" + mGetDataTemplate.template_data + "\');");')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                        }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    else")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                        // 修改，打开旧报告")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                        if (!string.IsNullOrEmpty(mGetExamReport.sr_data))")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                        {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                            uc_sring1.chromeBrowser.ExecuteScriptAsync("f_load_template(\'" + mGetExamReport.sr_data + "\');");')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                            mLoadMode = 1;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                        }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            catch (Exception ex)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                LogManager.WriteLog("打开报告出错：" + ex.Message);')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            finally")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                context.Dispose();")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            #endregion 打开报告")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            Thread.Sleep(1000);")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            mTimes++;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        //模板加载成功，如果是修改报告则不用回写病人信息")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        if (EditorStatus.G_TemplateLoadingStatus && mLoadMode == 1)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            EditorStatus.G_PatientInformationUpdateStatus = true; //设置病人信息回写为完成")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            return;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    });")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    mT1.IsBackground = true;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    mT1.Start();")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    //2.判断模板加载好，并进行回写报告")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    var mT2 = new Thread(() =>")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        int mTimes = 0; //回写时间")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                        //等待10秒判断模板有没有加载好")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        while (mTimes < 40)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            //新增报告,模板加载好，回写没有好，进行回写")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            if (EditorStatus.G_TemplateLoadingStatus && !EditorStatus.G_PatientInformationUpdateStatus")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                && mLoadMode == 0)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                mT1.Abort();")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                string mPatientInformation = Encoding.Default.GetString(Convert.FromBase64String(S_Args[2]));")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                //{"a":"aa", "b":"b"}')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                //根据模板iid查询回写病人信息的SQL")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                string mParameter = Encoding.Default.GetString(Convert.FromBase64String(S_Args[1]));")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                //解析参数")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                SaveEventParameter mSaveEventReportParameter = new JavaScriptSerializer()")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                     .Deserialize<SaveEventParameter>(mParameter);")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                ExamReportParameter mReport = mSaveEventReportParameter.parameter;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                //JObject mJobject = JObject.Parse(mParameter);")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                long mExamIid = mReport.exam_iid; //检查表iid")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                                                  //long mExamIid = Convert.ToInt64(mJobject["exam_iid"]); //检查表iid')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                long mTemplatIid = mReport.sr_templat_iid; //模板表iid")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                                                           //long mTemplatIid = Convert.ToInt64(mJobject["sr_templat_iid"]); //模板表iid')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                PostgreSQLContext context = new PostgreSQLContext(new PostgreSQLConnectionFactory(DBConnectionString.POSTGRE_SQL));")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                try")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    var m_q_datatemplat = context.Query<sr_data_templat>();")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    var mGetDataTemplate = m_q_datatemplat.Where(a => a.iid == mTemplatIid)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                        .Select(a => new")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                        {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                            a.sql")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                        }).FirstOrDefault();")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    if (mGetDataTemplate == null)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                        break;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    string mSql = mGetDataTemplate.sql;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                    LogManager.WriteLog("传递的sql:" + mSql);')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                    //string mSql = @"select t.* from icnris_exam t where iid=:iid";')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                    //mSql = "select t.cname as \\"name\\", t.CSEX as \\"sex\\", t.CAGE as \\"age\\" from icnris_exam t where iid=:iid";')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    //mExamIid = 147073;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                    uDataSet mDataSet = new uDataSet(new string[] { mSql }, new uParameter[] { new uParameter(":iid", mExamIid) }); //147073')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    if (mDataSet.RowCount() == 0)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                        return;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    foreach (DataTable dt in mDataSet.Tables)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                        foreach (DataRow dr in dt.Rows) ///遍历所有的行")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                        {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                            StringBuilder mPatientInformationStr = new StringBuilder(); //拼接病人信息回写数据的json")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                            mPatientInformationStr.Append("{");')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                            foreach (DataColumn dc in dt.Columns) //遍历所有的列")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                            {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                                mPatientInformationStr.Append("\\"" + dc.ColumnName + "\\":\\"" + dr[dc] + "\\",");')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                                LogManager.WriteLog(dt.TableName + ", " + dc.ColumnName + ", " + dr[dc] + ", "); //表名,列名,单元格数据')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                            }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                            if (mPatientInformationStr.Length > 1)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                            {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                                mPatientInformationStr.Remove(mPatientInformationStr.Length - 1, 1); //去除最后一个逗号,")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                            }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                            mPatientInformationStr.Append("}");')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                            LogManager.WriteLog("json数据:" + mPatientInformationStr.ToString() + "原数据:" + mPatientInformation);')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                            //调用回写数据的js方法")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                            uc_sring1.chromeBrowser.ExecuteScriptAsync("f_set_data(\'" + mPatientInformationStr + "\');");')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                        }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                    //string mName = mDataSet.GetItemString(1, "cname");')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    //原来的回写数据")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                    //uc_sring1.chromeBrowser.ExecuteScriptAsync("f_set_data(\'" + mPatientInformation + "\');");')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                catch (Exception ex)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                    LogManager.WriteLog("回写报告出错：" + ex.Message);')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                finally")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    context.Dispose();")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            else if (EditorStatus.G_TemplateLoadingStatus && EditorStatus.G_PatientInformationUpdateStatus)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                break;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            Thread.Sleep(500);")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            mTimes++;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        //模板加载了10秒还没好")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        if (mTimes > 39)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//            //MessageBox.Show("模板加载超时！", "提示", MessageBoxButtons.OK, MessageBoxIcon.Information, MessageBoxDefaultButton.Button1, MessageBoxOptions.DefaultDesktopOnly);')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    });")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    mT2.IsBackground = true;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    mT2.Start();")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    //3.只判断病人信息是否回写完成")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    var mT3 = new Thread(() =>")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        int mTimes = 0; //回写时间")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        while (mTimes < 40)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            if (EditorStatus.G_TemplateLoadingStatus && EditorStatus.G_PatientInformationUpdateStatus)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                mT2.Abort();")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                //MessageBox.Show("回写完成！", "回写提示", MessageBoxButtons.OK, MessageBoxIcon.Information, MessageBoxDefaultButton.Button1, MessageBoxOptions.DefaultDesktopOnly);')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                break;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            else if (!EditorStatus.G_TemplateLoadingStatus && EditorStatus.G_PatientInformationUpdateStatus)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            {//模板加载超时，回写成功")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                mT2.Abort();")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                //MessageBox.Show("模板加载失败，回写成功！", "提示", MessageBoxButtons.OK, MessageBoxIcon.Information, MessageBoxDefaultButton.Button1, MessageBoxOptions.DefaultDesktopOnly);')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                break;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            Thread.Sleep(500);")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            mTimes++;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        if (mTimes > 39)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//            //MessageBox.Show("回写失败！", "回写提示", MessageBoxButtons.OK, MessageBoxIcon.Information, MessageBoxDefaultButton.Button1, MessageBoxOptions.DefaultDesktopOnly);')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    });")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    mT3.IsBackground = true;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    mT3.Start();")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//catch (Exception ex)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//    LogManager.WriteLog("初始化报告出错:" + ex.Message);')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//finally")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token preprocessor property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("region")]),s._v(" 注释 2023/01/17 13:47 备份")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("////1.打开报告加载模板")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//new Thread(() =>")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    int mTimes = 0; //执行时间")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    while (!EditorStatus.G_TemplateLoadingStatus && mTimes < 10)")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        #region 打开报告")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        PostgreSQLContext context = new PostgreSQLContext(new PostgreSQLConnectionFactory(DBConnectionString.POSTGRE_SQL));")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        try")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            //判断新增报告还是修改报告")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            if (S_Args != null)")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                string mParameter = Encoding.Default.GetString(Convert.FromBase64String(S_Args[1]));")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                JObject mJobject = JObject.Parse(mParameter);")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                long mExamIid = Convert.ToInt64(mJobject["exam_iid"]);')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                // 根据检查表iid查询是否有报告")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                var mGetExamReport = context.Query<sr_exam_report>().Where(a => a.exam_iid == mExamIid && a.flag == "9")')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    .Select(a => new { a.sr_data }).FirstOrDefault();")]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                if (mGetExamReport == null)")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    // 新增，打开对应的模板")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                    long mTemplatIid = Convert.ToInt64(mJobject["sr_templat_iid"]);')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    var m_q_datatemplat = context.Query<sr_data_templat>();")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    var mGetDataTemplate = m_q_datatemplat.Where(a => a.iid == mTemplatIid)")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                        .Select(a => new")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                        {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                            a.template_data")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                        }).FirstOrDefault();")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    if (!string.IsNullOrEmpty(mGetDataTemplate.template_data))")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                        //EditorStatus.G_PatientInformationUpdateStatus = false; //设置病人信息回写为未完成")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                        uc_sring1.chromeBrowser.ExecuteScriptAsync("f_load_template(\'" + mGetDataTemplate.template_data + "\');");')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                        //EditorStatus.G_TemplateLoadingStatus = true; //设置模板状态为加载")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    }")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                }")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                else")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                    //MessageBox.Show("打开报告");')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    // 修改，打开旧报告")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    if (!string.IsNullOrEmpty(mGetExamReport.sr_data))")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                        //EditorStatus.G_TemplateLoadingStatus = true; //设置模板状态为加载完成")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                        EditorStatus.G_PatientInformationUpdateStatus = true; //设置病人信息回写为完成")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                        uc_sring1.chromeBrowser.ExecuteScriptAsync("f_load_template(\'" + mGetExamReport.sr_data + "\');");')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    }")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                }")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                //EditorStatus.G_TemplateLoadingStatus = true; //设置模板状态为加载完成")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            }")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        catch (Exception ex)")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//            LogManager.WriteLog("打开报告出错：" + ex.Message);')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        finally")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            context.Dispose();")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        #endregion 打开报告")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        Thread.Sleep(1000);")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        mTimes++;")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    }")]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}).Start();")]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("////判断模板加载好，并进行回写报告")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//new Thread(() =>")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    int mWriteBackTimes = 0; //回写时间")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    while (mWriteBackTimes < 9)")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        //模板加载好，回写没有好，进行回写")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        if (EditorStatus.G_TemplateLoadingStatus &&")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            mWriteBackTimes < 10 && !EditorStatus.G_PatientInformationUpdateStatus)")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//            //MessageBox.Show("模板加载完成！", "提示", MessageBoxButtons.OK, MessageBoxIcon.Information, MessageBoxDefaultButton.Button1, MessageBoxOptions.DefaultDesktopOnly);')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            #region 回写病人信息")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            string mPatientInformation = Encoding.Default.GetString(Convert.FromBase64String(S_Args[2]));")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//            uc_sring1.chromeBrowser.ExecuteScriptAsync("f_set_data(\'" + mPatientInformation + "\');");')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            #endregion 回写病人信息")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            Thread.Sleep(1000);")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            mWriteBackTimes++;")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        //模板  加载好，回写了5秒还没好")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        else if (EditorStatus.G_TemplateLoadingStatus &&")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            mWriteBackTimes > 9 && !EditorStatus.G_PatientInformationUpdateStatus)")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//            MessageBox.Show("回写失败");')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            break;")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        //模板没加载好，加载了5秒还没好")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        else if (!EditorStatus.G_TemplateLoadingStatus &&")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            mWriteBackTimes > 9)")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {//回写了5秒后还没返回True，提示")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//            MessageBox.Show("模板加载失败！", "提示", MessageBoxButtons.OK, MessageBoxIcon.Information, MessageBoxDefaultButton.Button1, MessageBoxOptions.DefaultDesktopOnly);')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            break;")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        else")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            Thread.Sleep(1000);")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            mWriteBackTimes++;")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    }")]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}).Start();")]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("////只判断病人信息是否回写完成")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//new Thread(() =>")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    int mWriteBackTimes = 0; //回写时间")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    while (true)")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        if (EditorStatus.G_PatientInformationUpdateStatus &&")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            mWriteBackTimes < 10)")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//            //MessageBox.Show("回写完成！", "回写提示", MessageBoxButtons.OK, MessageBoxIcon.Information, MessageBoxDefaultButton.Button1, MessageBoxOptions.DefaultDesktopOnly);')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            break;")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        else if (!EditorStatus.G_PatientInformationUpdateStatus &&")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            mWriteBackTimes > 9)")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {//回写了5秒后还没返回True，提示回写失败")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//            MessageBox.Show("回写失败！", "回写提示", MessageBoxButtons.OK, MessageBoxIcon.Information, MessageBoxDefaultButton.Button1, MessageBoxOptions.DefaultDesktopOnly);')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            break;")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        else")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            Thread.Sleep(1000);")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            mWriteBackTimes++;")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    }")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}).Start();")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token preprocessor property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endregion")]),s._v(" 注释 2023/01/17 13:47 备份")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br"),n("span",{staticClass:"line-number"},[s._v("93")]),n("br"),n("span",{staticClass:"line-number"},[s._v("94")]),n("br"),n("span",{staticClass:"line-number"},[s._v("95")]),n("br"),n("span",{staticClass:"line-number"},[s._v("96")]),n("br"),n("span",{staticClass:"line-number"},[s._v("97")]),n("br"),n("span",{staticClass:"line-number"},[s._v("98")]),n("br"),n("span",{staticClass:"line-number"},[s._v("99")]),n("br"),n("span",{staticClass:"line-number"},[s._v("100")]),n("br"),n("span",{staticClass:"line-number"},[s._v("101")]),n("br"),n("span",{staticClass:"line-number"},[s._v("102")]),n("br"),n("span",{staticClass:"line-number"},[s._v("103")]),n("br"),n("span",{staticClass:"line-number"},[s._v("104")]),n("br"),n("span",{staticClass:"line-number"},[s._v("105")]),n("br"),n("span",{staticClass:"line-number"},[s._v("106")]),n("br"),n("span",{staticClass:"line-number"},[s._v("107")]),n("br"),n("span",{staticClass:"line-number"},[s._v("108")]),n("br"),n("span",{staticClass:"line-number"},[s._v("109")]),n("br"),n("span",{staticClass:"line-number"},[s._v("110")]),n("br"),n("span",{staticClass:"line-number"},[s._v("111")]),n("br"),n("span",{staticClass:"line-number"},[s._v("112")]),n("br"),n("span",{staticClass:"line-number"},[s._v("113")]),n("br"),n("span",{staticClass:"line-number"},[s._v("114")]),n("br"),n("span",{staticClass:"line-number"},[s._v("115")]),n("br"),n("span",{staticClass:"line-number"},[s._v("116")]),n("br"),n("span",{staticClass:"line-number"},[s._v("117")]),n("br"),n("span",{staticClass:"line-number"},[s._v("118")]),n("br"),n("span",{staticClass:"line-number"},[s._v("119")]),n("br"),n("span",{staticClass:"line-number"},[s._v("120")]),n("br"),n("span",{staticClass:"line-number"},[s._v("121")]),n("br"),n("span",{staticClass:"line-number"},[s._v("122")]),n("br"),n("span",{staticClass:"line-number"},[s._v("123")]),n("br"),n("span",{staticClass:"line-number"},[s._v("124")]),n("br"),n("span",{staticClass:"line-number"},[s._v("125")]),n("br"),n("span",{staticClass:"line-number"},[s._v("126")]),n("br"),n("span",{staticClass:"line-number"},[s._v("127")]),n("br"),n("span",{staticClass:"line-number"},[s._v("128")]),n("br"),n("span",{staticClass:"line-number"},[s._v("129")]),n("br"),n("span",{staticClass:"line-number"},[s._v("130")]),n("br"),n("span",{staticClass:"line-number"},[s._v("131")]),n("br"),n("span",{staticClass:"line-number"},[s._v("132")]),n("br"),n("span",{staticClass:"line-number"},[s._v("133")]),n("br"),n("span",{staticClass:"line-number"},[s._v("134")]),n("br"),n("span",{staticClass:"line-number"},[s._v("135")]),n("br"),n("span",{staticClass:"line-number"},[s._v("136")]),n("br"),n("span",{staticClass:"line-number"},[s._v("137")]),n("br"),n("span",{staticClass:"line-number"},[s._v("138")]),n("br"),n("span",{staticClass:"line-number"},[s._v("139")]),n("br"),n("span",{staticClass:"line-number"},[s._v("140")]),n("br"),n("span",{staticClass:"line-number"},[s._v("141")]),n("br"),n("span",{staticClass:"line-number"},[s._v("142")]),n("br"),n("span",{staticClass:"line-number"},[s._v("143")]),n("br"),n("span",{staticClass:"line-number"},[s._v("144")]),n("br"),n("span",{staticClass:"line-number"},[s._v("145")]),n("br"),n("span",{staticClass:"line-number"},[s._v("146")]),n("br"),n("span",{staticClass:"line-number"},[s._v("147")]),n("br"),n("span",{staticClass:"line-number"},[s._v("148")]),n("br"),n("span",{staticClass:"line-number"},[s._v("149")]),n("br"),n("span",{staticClass:"line-number"},[s._v("150")]),n("br"),n("span",{staticClass:"line-number"},[s._v("151")]),n("br"),n("span",{staticClass:"line-number"},[s._v("152")]),n("br"),n("span",{staticClass:"line-number"},[s._v("153")]),n("br"),n("span",{staticClass:"line-number"},[s._v("154")]),n("br"),n("span",{staticClass:"line-number"},[s._v("155")]),n("br"),n("span",{staticClass:"line-number"},[s._v("156")]),n("br"),n("span",{staticClass:"line-number"},[s._v("157")]),n("br"),n("span",{staticClass:"line-number"},[s._v("158")]),n("br"),n("span",{staticClass:"line-number"},[s._v("159")]),n("br"),n("span",{staticClass:"line-number"},[s._v("160")]),n("br"),n("span",{staticClass:"line-number"},[s._v("161")]),n("br"),n("span",{staticClass:"line-number"},[s._v("162")]),n("br"),n("span",{staticClass:"line-number"},[s._v("163")]),n("br"),n("span",{staticClass:"line-number"},[s._v("164")]),n("br"),n("span",{staticClass:"line-number"},[s._v("165")]),n("br"),n("span",{staticClass:"line-number"},[s._v("166")]),n("br"),n("span",{staticClass:"line-number"},[s._v("167")]),n("br"),n("span",{staticClass:"line-number"},[s._v("168")]),n("br"),n("span",{staticClass:"line-number"},[s._v("169")]),n("br"),n("span",{staticClass:"line-number"},[s._v("170")]),n("br"),n("span",{staticClass:"line-number"},[s._v("171")]),n("br"),n("span",{staticClass:"line-number"},[s._v("172")]),n("br"),n("span",{staticClass:"line-number"},[s._v("173")]),n("br"),n("span",{staticClass:"line-number"},[s._v("174")]),n("br"),n("span",{staticClass:"line-number"},[s._v("175")]),n("br"),n("span",{staticClass:"line-number"},[s._v("176")]),n("br"),n("span",{staticClass:"line-number"},[s._v("177")]),n("br"),n("span",{staticClass:"line-number"},[s._v("178")]),n("br"),n("span",{staticClass:"line-number"},[s._v("179")]),n("br"),n("span",{staticClass:"line-number"},[s._v("180")]),n("br"),n("span",{staticClass:"line-number"},[s._v("181")]),n("br"),n("span",{staticClass:"line-number"},[s._v("182")]),n("br"),n("span",{staticClass:"line-number"},[s._v("183")]),n("br"),n("span",{staticClass:"line-number"},[s._v("184")]),n("br"),n("span",{staticClass:"line-number"},[s._v("185")]),n("br"),n("span",{staticClass:"line-number"},[s._v("186")]),n("br"),n("span",{staticClass:"line-number"},[s._v("187")]),n("br"),n("span",{staticClass:"line-number"},[s._v("188")]),n("br"),n("span",{staticClass:"line-number"},[s._v("189")]),n("br"),n("span",{staticClass:"line-number"},[s._v("190")]),n("br"),n("span",{staticClass:"line-number"},[s._v("191")]),n("br"),n("span",{staticClass:"line-number"},[s._v("192")]),n("br"),n("span",{staticClass:"line-number"},[s._v("193")]),n("br"),n("span",{staticClass:"line-number"},[s._v("194")]),n("br"),n("span",{staticClass:"line-number"},[s._v("195")]),n("br"),n("span",{staticClass:"line-number"},[s._v("196")]),n("br"),n("span",{staticClass:"line-number"},[s._v("197")]),n("br"),n("span",{staticClass:"line-number"},[s._v("198")]),n("br"),n("span",{staticClass:"line-number"},[s._v("199")]),n("br"),n("span",{staticClass:"line-number"},[s._v("200")]),n("br"),n("span",{staticClass:"line-number"},[s._v("201")]),n("br"),n("span",{staticClass:"line-number"},[s._v("202")]),n("br"),n("span",{staticClass:"line-number"},[s._v("203")]),n("br"),n("span",{staticClass:"line-number"},[s._v("204")]),n("br"),n("span",{staticClass:"line-number"},[s._v("205")]),n("br"),n("span",{staticClass:"line-number"},[s._v("206")]),n("br"),n("span",{staticClass:"line-number"},[s._v("207")]),n("br"),n("span",{staticClass:"line-number"},[s._v("208")]),n("br"),n("span",{staticClass:"line-number"},[s._v("209")]),n("br"),n("span",{staticClass:"line-number"},[s._v("210")]),n("br"),n("span",{staticClass:"line-number"},[s._v("211")]),n("br"),n("span",{staticClass:"line-number"},[s._v("212")]),n("br"),n("span",{staticClass:"line-number"},[s._v("213")]),n("br"),n("span",{staticClass:"line-number"},[s._v("214")]),n("br"),n("span",{staticClass:"line-number"},[s._v("215")]),n("br"),n("span",{staticClass:"line-number"},[s._v("216")]),n("br"),n("span",{staticClass:"line-number"},[s._v("217")]),n("br"),n("span",{staticClass:"line-number"},[s._v("218")]),n("br"),n("span",{staticClass:"line-number"},[s._v("219")]),n("br"),n("span",{staticClass:"line-number"},[s._v("220")]),n("br"),n("span",{staticClass:"line-number"},[s._v("221")]),n("br"),n("span",{staticClass:"line-number"},[s._v("222")]),n("br"),n("span",{staticClass:"line-number"},[s._v("223")]),n("br"),n("span",{staticClass:"line-number"},[s._v("224")]),n("br"),n("span",{staticClass:"line-number"},[s._v("225")]),n("br"),n("span",{staticClass:"line-number"},[s._v("226")]),n("br"),n("span",{staticClass:"line-number"},[s._v("227")]),n("br"),n("span",{staticClass:"line-number"},[s._v("228")]),n("br"),n("span",{staticClass:"line-number"},[s._v("229")]),n("br"),n("span",{staticClass:"line-number"},[s._v("230")]),n("br"),n("span",{staticClass:"line-number"},[s._v("231")]),n("br"),n("span",{staticClass:"line-number"},[s._v("232")]),n("br"),n("span",{staticClass:"line-number"},[s._v("233")]),n("br"),n("span",{staticClass:"line-number"},[s._v("234")]),n("br"),n("span",{staticClass:"line-number"},[s._v("235")]),n("br"),n("span",{staticClass:"line-number"},[s._v("236")]),n("br"),n("span",{staticClass:"line-number"},[s._v("237")]),n("br"),n("span",{staticClass:"line-number"},[s._v("238")]),n("br"),n("span",{staticClass:"line-number"},[s._v("239")]),n("br"),n("span",{staticClass:"line-number"},[s._v("240")]),n("br"),n("span",{staticClass:"line-number"},[s._v("241")]),n("br"),n("span",{staticClass:"line-number"},[s._v("242")]),n("br"),n("span",{staticClass:"line-number"},[s._v("243")]),n("br"),n("span",{staticClass:"line-number"},[s._v("244")]),n("br"),n("span",{staticClass:"line-number"},[s._v("245")]),n("br"),n("span",{staticClass:"line-number"},[s._v("246")]),n("br"),n("span",{staticClass:"line-number"},[s._v("247")]),n("br"),n("span",{staticClass:"line-number"},[s._v("248")]),n("br"),n("span",{staticClass:"line-number"},[s._v("249")]),n("br"),n("span",{staticClass:"line-number"},[s._v("250")]),n("br"),n("span",{staticClass:"line-number"},[s._v("251")]),n("br"),n("span",{staticClass:"line-number"},[s._v("252")]),n("br"),n("span",{staticClass:"line-number"},[s._v("253")]),n("br"),n("span",{staticClass:"line-number"},[s._v("254")]),n("br"),n("span",{staticClass:"line-number"},[s._v("255")]),n("br"),n("span",{staticClass:"line-number"},[s._v("256")]),n("br"),n("span",{staticClass:"line-number"},[s._v("257")]),n("br"),n("span",{staticClass:"line-number"},[s._v("258")]),n("br"),n("span",{staticClass:"line-number"},[s._v("259")]),n("br"),n("span",{staticClass:"line-number"},[s._v("260")]),n("br"),n("span",{staticClass:"line-number"},[s._v("261")]),n("br"),n("span",{staticClass:"line-number"},[s._v("262")]),n("br"),n("span",{staticClass:"line-number"},[s._v("263")]),n("br"),n("span",{staticClass:"line-number"},[s._v("264")]),n("br"),n("span",{staticClass:"line-number"},[s._v("265")]),n("br"),n("span",{staticClass:"line-number"},[s._v("266")]),n("br"),n("span",{staticClass:"line-number"},[s._v("267")]),n("br"),n("span",{staticClass:"line-number"},[s._v("268")]),n("br"),n("span",{staticClass:"line-number"},[s._v("269")]),n("br"),n("span",{staticClass:"line-number"},[s._v("270")]),n("br"),n("span",{staticClass:"line-number"},[s._v("271")]),n("br"),n("span",{staticClass:"line-number"},[s._v("272")]),n("br"),n("span",{staticClass:"line-number"},[s._v("273")]),n("br"),n("span",{staticClass:"line-number"},[s._v("274")]),n("br"),n("span",{staticClass:"line-number"},[s._v("275")]),n("br"),n("span",{staticClass:"line-number"},[s._v("276")]),n("br"),n("span",{staticClass:"line-number"},[s._v("277")]),n("br"),n("span",{staticClass:"line-number"},[s._v("278")]),n("br"),n("span",{staticClass:"line-number"},[s._v("279")]),n("br"),n("span",{staticClass:"line-number"},[s._v("280")]),n("br"),n("span",{staticClass:"line-number"},[s._v("281")]),n("br"),n("span",{staticClass:"line-number"},[s._v("282")]),n("br"),n("span",{staticClass:"line-number"},[s._v("283")]),n("br"),n("span",{staticClass:"line-number"},[s._v("284")]),n("br"),n("span",{staticClass:"line-number"},[s._v("285")]),n("br"),n("span",{staticClass:"line-number"},[s._v("286")]),n("br"),n("span",{staticClass:"line-number"},[s._v("287")]),n("br"),n("span",{staticClass:"line-number"},[s._v("288")]),n("br"),n("span",{staticClass:"line-number"},[s._v("289")]),n("br"),n("span",{staticClass:"line-number"},[s._v("290")]),n("br"),n("span",{staticClass:"line-number"},[s._v("291")]),n("br"),n("span",{staticClass:"line-number"},[s._v("292")]),n("br"),n("span",{staticClass:"line-number"},[s._v("293")]),n("br"),n("span",{staticClass:"line-number"},[s._v("294")]),n("br"),n("span",{staticClass:"line-number"},[s._v("295")]),n("br"),n("span",{staticClass:"line-number"},[s._v("296")]),n("br"),n("span",{staticClass:"line-number"},[s._v("297")]),n("br"),n("span",{staticClass:"line-number"},[s._v("298")]),n("br"),n("span",{staticClass:"line-number"},[s._v("299")]),n("br"),n("span",{staticClass:"line-number"},[s._v("300")]),n("br"),n("span",{staticClass:"line-number"},[s._v("301")]),n("br"),n("span",{staticClass:"line-number"},[s._v("302")]),n("br"),n("span",{staticClass:"line-number"},[s._v("303")]),n("br"),n("span",{staticClass:"line-number"},[s._v("304")]),n("br"),n("span",{staticClass:"line-number"},[s._v("305")]),n("br"),n("span",{staticClass:"line-number"},[s._v("306")]),n("br"),n("span",{staticClass:"line-number"},[s._v("307")]),n("br"),n("span",{staticClass:"line-number"},[s._v("308")]),n("br"),n("span",{staticClass:"line-number"},[s._v("309")]),n("br"),n("span",{staticClass:"line-number"},[s._v("310")]),n("br"),n("span",{staticClass:"line-number"},[s._v("311")]),n("br"),n("span",{staticClass:"line-number"},[s._v("312")]),n("br"),n("span",{staticClass:"line-number"},[s._v("313")]),n("br"),n("span",{staticClass:"line-number"},[s._v("314")]),n("br"),n("span",{staticClass:"line-number"},[s._v("315")]),n("br"),n("span",{staticClass:"line-number"},[s._v("316")]),n("br"),n("span",{staticClass:"line-number"},[s._v("317")]),n("br"),n("span",{staticClass:"line-number"},[s._v("318")]),n("br"),n("span",{staticClass:"line-number"},[s._v("319")]),n("br"),n("span",{staticClass:"line-number"},[s._v("320")]),n("br"),n("span",{staticClass:"line-number"},[s._v("321")]),n("br"),n("span",{staticClass:"line-number"},[s._v("322")]),n("br"),n("span",{staticClass:"line-number"},[s._v("323")]),n("br"),n("span",{staticClass:"line-number"},[s._v("324")]),n("br"),n("span",{staticClass:"line-number"},[s._v("325")]),n("br"),n("span",{staticClass:"line-number"},[s._v("326")]),n("br"),n("span",{staticClass:"line-number"},[s._v("327")]),n("br"),n("span",{staticClass:"line-number"},[s._v("328")]),n("br"),n("span",{staticClass:"line-number"},[s._v("329")]),n("br"),n("span",{staticClass:"line-number"},[s._v("330")]),n("br"),n("span",{staticClass:"line-number"},[s._v("331")]),n("br"),n("span",{staticClass:"line-number"},[s._v("332")]),n("br"),n("span",{staticClass:"line-number"},[s._v("333")]),n("br"),n("span",{staticClass:"line-number"},[s._v("334")]),n("br"),n("span",{staticClass:"line-number"},[s._v("335")]),n("br"),n("span",{staticClass:"line-number"},[s._v("336")]),n("br"),n("span",{staticClass:"line-number"},[s._v("337")]),n("br"),n("span",{staticClass:"line-number"},[s._v("338")]),n("br"),n("span",{staticClass:"line-number"},[s._v("339")]),n("br"),n("span",{staticClass:"line-number"},[s._v("340")]),n("br"),n("span",{staticClass:"line-number"},[s._v("341")]),n("br"),n("span",{staticClass:"line-number"},[s._v("342")]),n("br"),n("span",{staticClass:"line-number"},[s._v("343")]),n("br"),n("span",{staticClass:"line-number"},[s._v("344")]),n("br"),n("span",{staticClass:"line-number"},[s._v("345")]),n("br"),n("span",{staticClass:"line-number"},[s._v("346")]),n("br"),n("span",{staticClass:"line-number"},[s._v("347")]),n("br"),n("span",{staticClass:"line-number"},[s._v("348")]),n("br"),n("span",{staticClass:"line-number"},[s._v("349")]),n("br"),n("span",{staticClass:"line-number"},[s._v("350")]),n("br"),n("span",{staticClass:"line-number"},[s._v("351")]),n("br"),n("span",{staticClass:"line-number"},[s._v("352")]),n("br"),n("span",{staticClass:"line-number"},[s._v("353")]),n("br"),n("span",{staticClass:"line-number"},[s._v("354")]),n("br"),n("span",{staticClass:"line-number"},[s._v("355")]),n("br"),n("span",{staticClass:"line-number"},[s._v("356")]),n("br"),n("span",{staticClass:"line-number"},[s._v("357")]),n("br"),n("span",{staticClass:"line-number"},[s._v("358")]),n("br"),n("span",{staticClass:"line-number"},[s._v("359")]),n("br"),n("span",{staticClass:"line-number"},[s._v("360")]),n("br"),n("span",{staticClass:"line-number"},[s._v("361")]),n("br"),n("span",{staticClass:"line-number"},[s._v("362")]),n("br"),n("span",{staticClass:"line-number"},[s._v("363")]),n("br"),n("span",{staticClass:"line-number"},[s._v("364")]),n("br"),n("span",{staticClass:"line-number"},[s._v("365")]),n("br")])]),n("p",[s._v("写报告, 网页加载完成")]),s._v(" "),n("div",{staticClass:"language-csharp line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-csharp"}},[n("code",[s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/// <summary>")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/// 网页加载完成事件")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/// </summary>")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('/// <param name="sender"></param>')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('/// <param name="e"></param>')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token return-type class-name"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("f_ChromeBrowser_FrameLoadEnd")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("object")])]),s._v(" sender"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("CefSharp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("FrameLoadEndEventArgs")]),s._v(" e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//MessageBox.Show("回写是否完成：" + EditorStatus.G_PatientInformationUpdateStatus);')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//MessageBox.Show("模板是否加载完成：" + EditorStatus.G_TemplateLoadingStatus);')]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token preprocessor property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("region")]),s._v(" 注释 旧写法 新写法也能完成效果 完成事件中回写数据")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//WaitDialogForm mWaitForm = null;")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//if (!S_IsLoad)")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//    mWaitForm = new WaitDialogForm("请稍后 ... ...", "提示");')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    mWaitForm.Show();")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    S_IsLoad = true;")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}")]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//#region 打开报告")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//PostgreSQLContext context = new PostgreSQLContext(new PostgreSQLConnectionFactory(DBConnectionString.POSTGRE_SQL));")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//try")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    //判断新增报告还是修改报告")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    if (S_Args != null)")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        string mParameter = Encoding.Default.GetString(Convert.FromBase64String(S_Args[1]));")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        JObject mJobject = JObject.Parse(mParameter);")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//        long mExamIid = Convert.ToInt64(mJobject["exam_iid"]);')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        // 根据检查表iid查询是否有报告")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//        var mGetExamReport = context.Query<sr_exam_report>().Where(a => a.exam_iid == mExamIid && a.flag == "9")')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            .Select(a => new { a.sr_data }).FirstOrDefault();")]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        if (mGetExamReport == null)")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            // 新增，打开对应的模板")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//            long mTemplatIid = Convert.ToInt64(mJobject["sr_templat_iid"]);')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            var m_q_datatemplat = context.Query<sr_data_templat>();")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            var mGetDataTemplate = m_q_datatemplat.Where(a => a.iid == mTemplatIid)")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                .Select(a => new {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    a.template_data")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                }).FirstOrDefault();")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            if (!string.IsNullOrEmpty(mGetDataTemplate.template_data))")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                //EditorStatus.G_TemplateLoadingStatus = false; //设置模板状态为未加载")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                //EditorStatus.G_PatientInformationUpdateStatus = false; //设置病人信息回写为未完成")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                uc_sring1.chromeBrowser.ExecuteScriptAsync("f_load_template(\'" + mGetDataTemplate.template_data + "\');");')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            }")]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            #region 回写病人信息")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            Thread mThread1 = new Thread(() =>")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                while (!EditorStatus.G_TemplateLoadingStatus)")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                {//每隔一秒判断模板加载是否完成")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    Thread.Sleep(1000);")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                }")]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                string mPatientInformation = Encoding.Default.GetString(Convert.FromBase64String(S_Args[2]));")]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                uc_sring1.chromeBrowser.ExecuteScriptAsync("f_set_data(\'" + mPatientInformation + "\');");')]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                #region 注释 异步获取js方法的返回值")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                //JavascriptResponse javascriptResponse = await uc_sring1.chromeBrowser.EvaluateScriptAsync("f_set_data(\'" + mPatientInformation + "\');");')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                //if (javascriptResponse.Success)")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                //{//javascript成功执行")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                //javascriptResponse.Result.ToString(); //返回值")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                //}")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                #endregion 异步获取js方法的返回值")]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            });")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            mThread1.Start();")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            #endregion 回写病人信息")]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            #region 注释 回写结束")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            //Thread mThread2 = new Thread(() =>")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            //{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            //    int mWriteBackTimes = 0; //回写时间")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            //    while (!EditorStatus.G_PatientInformationUpdateStatus &&")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            //        mWriteBackTimes < 5)")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            //    {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            //        Thread.Sleep(1000);")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            //        mWriteBackTimes++;")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            //    }")]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            //});")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            //mThread2.Start();")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            #endregion 回写结束")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        else")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//            MessageBox.Show("打开报告");')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            // 修改，打开旧报告")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            if (!string.IsNullOrEmpty(mGetExamReport.sr_data))")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                //EditorStatus.G_TemplateLoadingStatus = true; //设置模板状态为加载完成")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                //EditorStatus.G_PatientInformationUpdateStatus = true; //设置病人信息回写为完成")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                uc_sring1.chromeBrowser.ExecuteScriptAsync("f_load_template(\'" + mGetExamReport.sr_data + "\');");')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            }")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    }")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//catch (Exception ex)")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//    LogManager.WriteLog("打开报告出错：" + ex.Message);')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//finally")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    context.Dispose();")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//#endregion 打开报告")]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//if (mWaitForm != null)")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    mWaitForm.Close();")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token preprocessor property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endregion")]),s._v(" 完成事件中回写数据")]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token preprocessor property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("region")]),s._v(" 注释 回写病人信息")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//if (S_IsLoad)")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    Thread t = new Thread(() =>")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        while (!EditorStatus.S_TemplateLoadingStatus)")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            Thread.Sleep(600);")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        string mPatientInformation = Encoding.Default.GetString(Convert.FromBase64String(S_Args[2]));")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//        //MessageBox.Show("回写的病人信息：" + mPatientInformation);')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//        uc_sring1.chromeBrowser.ExecuteScriptAsync("f_set_data(\'" + mPatientInformation + "\');");')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//        //MessageBox.Show("开始回写" + EditorStatus.S_TemplateLoadingStatus);')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    });")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    t.Start();")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    if (mWaitForm != null)")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        mWaitForm.Close();")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    }")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}")]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token preprocessor property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endregion")]),s._v(" 回写病人信息")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br"),n("span",{staticClass:"line-number"},[s._v("93")]),n("br"),n("span",{staticClass:"line-number"},[s._v("94")]),n("br"),n("span",{staticClass:"line-number"},[s._v("95")]),n("br"),n("span",{staticClass:"line-number"},[s._v("96")]),n("br"),n("span",{staticClass:"line-number"},[s._v("97")]),n("br"),n("span",{staticClass:"line-number"},[s._v("98")]),n("br"),n("span",{staticClass:"line-number"},[s._v("99")]),n("br"),n("span",{staticClass:"line-number"},[s._v("100")]),n("br"),n("span",{staticClass:"line-number"},[s._v("101")]),n("br"),n("span",{staticClass:"line-number"},[s._v("102")]),n("br"),n("span",{staticClass:"line-number"},[s._v("103")]),n("br"),n("span",{staticClass:"line-number"},[s._v("104")]),n("br"),n("span",{staticClass:"line-number"},[s._v("105")]),n("br"),n("span",{staticClass:"line-number"},[s._v("106")]),n("br"),n("span",{staticClass:"line-number"},[s._v("107")]),n("br"),n("span",{staticClass:"line-number"},[s._v("108")]),n("br"),n("span",{staticClass:"line-number"},[s._v("109")]),n("br"),n("span",{staticClass:"line-number"},[s._v("110")]),n("br"),n("span",{staticClass:"line-number"},[s._v("111")]),n("br"),n("span",{staticClass:"line-number"},[s._v("112")]),n("br"),n("span",{staticClass:"line-number"},[s._v("113")]),n("br"),n("span",{staticClass:"line-number"},[s._v("114")]),n("br"),n("span",{staticClass:"line-number"},[s._v("115")]),n("br"),n("span",{staticClass:"line-number"},[s._v("116")]),n("br"),n("span",{staticClass:"line-number"},[s._v("117")]),n("br"),n("span",{staticClass:"line-number"},[s._v("118")]),n("br"),n("span",{staticClass:"line-number"},[s._v("119")]),n("br"),n("span",{staticClass:"line-number"},[s._v("120")]),n("br"),n("span",{staticClass:"line-number"},[s._v("121")]),n("br"),n("span",{staticClass:"line-number"},[s._v("122")]),n("br"),n("span",{staticClass:"line-number"},[s._v("123")]),n("br"),n("span",{staticClass:"line-number"},[s._v("124")]),n("br"),n("span",{staticClass:"line-number"},[s._v("125")]),n("br"),n("span",{staticClass:"line-number"},[s._v("126")]),n("br"),n("span",{staticClass:"line-number"},[s._v("127")]),n("br"),n("span",{staticClass:"line-number"},[s._v("128")]),n("br"),n("span",{staticClass:"line-number"},[s._v("129")]),n("br"),n("span",{staticClass:"line-number"},[s._v("130")]),n("br"),n("span",{staticClass:"line-number"},[s._v("131")]),n("br"),n("span",{staticClass:"line-number"},[s._v("132")]),n("br"),n("span",{staticClass:"line-number"},[s._v("133")]),n("br"),n("span",{staticClass:"line-number"},[s._v("134")]),n("br"),n("span",{staticClass:"line-number"},[s._v("135")]),n("br"),n("span",{staticClass:"line-number"},[s._v("136")]),n("br"),n("span",{staticClass:"line-number"},[s._v("137")]),n("br"),n("span",{staticClass:"line-number"},[s._v("138")]),n("br"),n("span",{staticClass:"line-number"},[s._v("139")]),n("br"),n("span",{staticClass:"line-number"},[s._v("140")]),n("br"),n("span",{staticClass:"line-number"},[s._v("141")]),n("br"),n("span",{staticClass:"line-number"},[s._v("142")]),n("br"),n("span",{staticClass:"line-number"},[s._v("143")]),n("br")])]),n("p",[s._v("写报告界面接收其他exe消息")]),s._v(" "),n("div",{staticClass:"language-csharp line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-csharp"}},[n("code",[s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//f_OpenReport();")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token preprocessor property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("region")]),s._v(" 注释打开报告")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//PostgreSQLContext context = new PostgreSQLContext(new PostgreSQLConnectionFactory(DBConnectionString.POSTGRE_SQL));")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//try")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    //判断新增报告还是修改报告")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    string mParameter = Encoding.Default.GetString(Convert.FromBase64String(S_Args[1]));")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    JObject mJobject = JObject.Parse(mParameter);")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//    long mExamIid = Convert.ToInt64(mJobject["exam_iid"]);')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    // 根据检查表iid查询是否有报告")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//    var mGetExamReport = context.Query<sr_exam_report>().Where(a => a.exam_iid == mExamIid && a.flag == "9")')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        .Select(a => new { a.sr_data }).FirstOrDefault();")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    if (mGetExamReport == null)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        // 新增，打开对应的模板")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//        long mTemplatIid = Convert.ToInt64(mJobject["sr_templat_iid"]);')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        var m_q_datatemplat = context.Query<sr_data_templat>();")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        var mGetDataTemplate = m_q_datatemplat.Where(a => a.iid == mTemplatIid)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            .Select(a => new {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                a.template_data")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            }).FirstOrDefault();")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        if (!string.IsNullOrEmpty(mGetDataTemplate.template_data))")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            EditorStatus.G_TemplateLoadingStatus = false; //设置模板状态为未加载")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            EditorStatus.G_PatientInformationUpdateStatus = false; //设置病人信息回写为未完成")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//            uc_sring1.chromeBrowser.ExecuteScriptAsync("f_load_template(\'" + mGetDataTemplate.template_data + "\');");')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        #region 回写病人信息")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        Thread t = new Thread(() =>")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            int mTimes = 0; //等待时间")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            while (!EditorStatus.G_TemplateLoadingStatus && mTimes < 10)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                Thread.Sleep(1000);")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                mTimes++;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            if (!EditorStatus.G_TemplateLoadingStatus)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                MessageBox.Show("模板加载失败");')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            else")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                string mPatientInformation = Encoding.Default.GetString(Convert.FromBase64String(S_Args[2]));")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                uc_sring1.chromeBrowser.ExecuteScriptAsync("f_set_data(\'" + mPatientInformation + "\');");')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        });")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        t.Start();")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        #endregion 回写病人信息")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        //判断病人信息是否回写完成")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        new Thread(() =>")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            int mWriteBackTimes = 0; //回写时间")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            while (true)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                if (EditorStatus.G_PatientInformationUpdateStatus &&")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    mWriteBackTimes < 10)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                    //MessageBox.Show("回写完成！", "回写提示", MessageBoxButtons.OK, MessageBoxIcon.Information, MessageBoxDefaultButton.Button1, MessageBoxOptions.DefaultDesktopOnly);')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    break;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                else if (!EditorStatus.G_PatientInformationUpdateStatus &&")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    mWriteBackTimes > 9)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                {//回写了5秒后还没返回True，提示回写失败")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                    MessageBox.Show("回写失败！", "回写提示", MessageBoxButtons.OK, MessageBoxIcon.Information, MessageBoxDefaultButton.Button1, MessageBoxOptions.DefaultDesktopOnly);')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    break;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                else")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    Thread.Sleep(500);")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    mWriteBackTimes++;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }).Start();")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    else")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        // 修改，打开旧报告")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        if (!string.IsNullOrEmpty(mGetExamReport.sr_data))")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//            uc_sring1.chromeBrowser.ExecuteScriptAsync("f_load_template(\'" + mGetExamReport.sr_data + "\');");')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//catch (Exception ex)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//    LogManager.WriteLog("ex=" + ex.Message);')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//finally")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    context.Dispose();")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token preprocessor property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endregion")]),s._v(" 打开报告")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br"),n("span",{staticClass:"line-number"},[s._v("93")]),n("br"),n("span",{staticClass:"line-number"},[s._v("94")]),n("br"),n("span",{staticClass:"line-number"},[s._v("95")]),n("br"),n("span",{staticClass:"line-number"},[s._v("96")]),n("br"),n("span",{staticClass:"line-number"},[s._v("97")]),n("br"),n("span",{staticClass:"line-number"},[s._v("98")]),n("br")])]),n("p",[s._v("写报告界面三个旧的方法")]),s._v(" "),n("div",{staticClass:"language-csharp line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-csharp"}},[n("code",[s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/// <summary>")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/// 旧的 打印报告")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/// </summary>")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('/// <param name="sender"></param>')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('/// <param name="e"></param>')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token return-type class-name"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("btn_print_Click")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("object")])]),s._v(" sender"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("EventArgs")]),s._v(" e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//MessageBox.Show(EditorStatus.S_TemplateLoadingStatus.ToString());")]),s._v("\n    uc_sring1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("f_Print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/// <summary>")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/// 旧的 审核")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/// </summary>")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('/// <param name="sender"></param>')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('/// <param name="e"></param>')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token return-type class-name"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("btn_examine_Click")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("object")])]),s._v(" sender"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("EventArgs")]),s._v(" e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    uc_sring1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("f_Examine")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    uc_sring1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("chromeBrowser"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ShowDevTools")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//打开控制台")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token preprocessor property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("region")]),s._v(" 注释")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//string mPatientInformation = Encoding.Default.GetString(Convert.FromBase64String(S_Args[2]));")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//MessageBox.Show("回写的病人信息：" + mPatientInformation);')]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//f_set_data")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//uc_sring1.chromeBrowser.ExecuteScriptAsync("f_set_data(\'" + mPatientInformation + "\');");')]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//DataTemplatParameter dataTemplat = new DataTemplatParameter();")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//dataTemplat.create_usercode = "胡金雅";')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//MessageBox.Show(dataTemplat.f_TestResult2());")]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//MessageBox.Show("回写是否完成：" + EditorStatus.G_PatientInformationUpdateStatus);')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//MessageBox.Show("模板是否加载完成：" + EditorStatus.G_TemplateLoadingStatus);')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token preprocessor property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endregion")]),s._v(" 注释")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/// <summary>")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/// 旧的 保存报告")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/// </summary>")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('/// <param name="sender"></param>')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('/// <param name="e"></param>')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token return-type class-name"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("btn_save_Click")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("object")])]),s._v(" sender"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("EventArgs")]),s._v(" e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//MessageBox.Show("Count: " + S_Args[0]);')]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token preprocessor property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("region")]),s._v(" 注释 保存报告")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PostgreSQLContext")]),s._v(" context "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constructor-invocation class-name"}},[s._v("PostgreSQLContext")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constructor-invocation class-name"}},[s._v("PostgreSQLConnectionFactory")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("DBConnectionString"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("POSTGRE_SQL"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("try")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//判断新增报告还是修改报告")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("string")])]),s._v(" mParameter "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Encoding"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Default"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("GetString")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Convert"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("FromBase64String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("S_Args"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//解析参数")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SaveEventParameter")]),s._v(" mSaveEventReportParameter "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constructor-invocation class-name"}},[s._v("JavaScriptSerializer")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token generic-method"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("Deserialize")]),n("span",{pre:!0,attrs:{class:"token generic class-name"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("SaveEventParameter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mParameter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ExamReportParameter")]),s._v(" mReport "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" mSaveEventReportParameter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("parameter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//JObject mJobject = JObject.Parse(mParameter);")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("long")])]),s._v(" mExamIid "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" mReport"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exam_iid"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//long mExamIid = Convert.ToInt64(mJobject["exam_iid"]);')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 根据检查表iid查询是否有报告")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")])]),s._v(" mGetExamReport "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" context"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token generic-method"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("Query")]),n("span",{pre:!0,attrs:{class:"token generic class-name"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("sr_exam_report"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("Where")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("a "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exam_iid "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" mExamIid "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("flag "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"9"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("Select")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("a "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("iid"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sr_data "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("FirstOrDefault")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mGetExamReport "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//新增")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//var a = Encoding.Default.GetString(Convert.FromBase64String(S_Args[1]));")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//MessageBox.Show(a);")]),s._v("\n            uc_sring1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("f_Save")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Encoding"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Default"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("GetString")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Convert"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("FromBase64String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("S_Args"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//修改")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//ExamReportParameter examReportParameter = new JavaScriptSerializer()")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    .Deserialize<ExamReportParameter>(mParameter);")]),s._v("\n            mReport"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("iid "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" mGetExamReport"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("iid"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ToString")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            mSaveEventReportParameter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("parameter "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" mReport"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//examReportParameter.iid = mGetExamReport.iid.ToString();")]),s._v("\n            MessageBox"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("Show")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constructor-invocation class-name"}},[s._v("JavaScriptSerializer")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("Serialize")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mSaveEventReportParameter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            uc_sring1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("f_Save")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constructor-invocation class-name"}},[s._v("JavaScriptSerializer")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("Serialize")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mSaveEventReportParameter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("catch")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Exception")]),s._v(" ex"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        LogManager"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("WriteLog")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"保存报告时发生错误："')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" ex"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Message"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("finally")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        context"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("Dispose")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token preprocessor property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endregion")]),s._v(" 注释 保存报告")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br"),n("span",{staticClass:"line-number"},[s._v("93")]),n("br"),n("span",{staticClass:"line-number"},[s._v("94")]),n("br")])]),n("p",[s._v("报告界面双击模板后加载模板")]),s._v(" "),n("div",{staticClass:"language-csharp line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-csharp"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//Report report = new Report();")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//report.f_TemplateWriteBack();")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//else")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    //写过报告,审核医师是当前登录者")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    //根据输入域id回写shys的签名图片")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//    string mSql = "select t.user_id, t.cuser_dzqm from icnris_userinfo t where user_id=:user_id";')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//    uDataSet mDataSet = new uDataSet(new string[] { mSql }, new uParameter[] { new uParameter(":user_id", "081") });')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//    //mDataSet = new uDataSet(new string[] { mSql }, new uParameter[] { new uParameter(":user_id", S_Args1[2]) });')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    if (mDataSet.RowCount() == 0)")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    {")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        return;")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    }")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//    LogManager.WriteLog("user_id:" + S_Args1[2]);')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    foreach (DataTable item in mDataSet.Tables)")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    {")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        foreach (DataRow dr1 in item.Rows) ///遍历所有的行")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            foreach (DataColumn dc in item.Columns) //遍历所有的列")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            {")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                //LogManager.WriteLog(item.TableName + ", " + dc.ColumnName + ", " + dr1[dc] + ", "); //表名,列名,单元格数据')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            }")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//            LogManager.WriteLog("电子签名图片:" + dr1[1]);')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            //调用js 根据输入域id设置图片")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            if (!string.IsNullOrEmpty(dr1[1] as String))")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            {")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                string Base64Str = "data:image/png;base64," + dr1[1];')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                //调用回写数据的js方法")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                StringBuilder mPatientInformationStr = new StringBuilder(); //拼接病人信息回写数据的json")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                mPatientInformationStr.Append("{");')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                mPatientInformationStr.Append("\\"shys\\":\\"" + S_Args1[3] + "\\""); //审核医师的姓名')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                mPatientInformationStr.Append("}");')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                uc_Sring.chromeBrowser.ExecuteScriptAsync("f_set_data(\'" + mPatientInformationStr + "\');");')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                uc_Sring.chromeBrowser.ExecuteScriptAsync("inteImg(\'" + "shysqm" + "\',\'" + Base64Str + "\');");')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            }")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    }")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token preprocessor property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("region")]),s._v(" 注释")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    Thread.Sleep(1000);")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("////回写信息")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//if (mGetDataTemplate == null)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    return;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//string mSql = mGetDataTemplate.sql;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//if (string.IsNullOrEmpty(mSql))")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    return;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//LogManager.WriteLog("传递的sql:" + mSql);')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("////根据模板iid查询回写病人信息的SQL")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//if (S_Args == null)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    return;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//string mParameter = Encoding.Default.GetString(Convert.FromBase64String(S_Args[1]));")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("////解析参数")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//SaveEventParameter mSaveEventReportParameter = new JavaScriptSerializer()")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//     .Deserialize<SaveEventParameter>(mParameter);")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//ExamReportParameter mReport = mSaveEventReportParameter.parameter;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("////JObject mJobject = JObject.Parse(mParameter);")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//long mExamIid = mReport.exam_iid; //检查表iid")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//LogManager.WriteLog("mExamIid" + mExamIid);')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('////string mSql = @"select t.* from icnris_exam t where iid=:iid";')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('////mSql = "select t.cname as \\"name\\", t.CSEX as \\"sex\\", t.CAGE as \\"age\\" from icnris_exam t where iid=:iid";')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("////mExamIid = 147073;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//uDataSet mDataSet = new uDataSet(new string[] { mSql }, new uParameter[] { new uParameter(":iid", mExamIid) }); //147073')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//if (mDataSet.RowCount() == 0)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    return;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//foreach (DataTable dt in mDataSet.Tables)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    foreach (DataRow dr in dt.Rows) ///遍历所有的行")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        StringBuilder mPatientInformationStr = new StringBuilder(); //拼接病人信息回写数据的json")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//        mPatientInformationStr.Append("{");')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        foreach (DataColumn dc in dt.Columns) //遍历所有的列")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//            mPatientInformationStr.Append("\\"" + dc.ColumnName + "\\":\\"" + dr[dc] + "\\",");')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//            LogManager.WriteLog(dt.TableName + ", " + dc.ColumnName + ", " + dr[dc] + ", "); //表名,列名,单元格数据')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//        mPatientInformationStr.Append("\\"bgys\\":\\"" + S_Args1[3] + "\\","); //报告医师的姓名')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        if (mPatientInformationStr.Length > 1)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            mPatientInformationStr.Remove(mPatientInformationStr.Length - 1, 1); //去除最后一个逗号,")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//        mPatientInformationStr.Append("}");')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//        LogManager.WriteLog("json数据:" + mPatientInformationStr.ToString());')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        //调用回写数据的js方法")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//        uc_Sring.chromeBrowser.ExecuteScriptAsync("f_set_data(\'" + mPatientInformationStr + "\');");')]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        //回写医生姓名和签名 提交报告医生是当前登陆者 bgys shys")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        //根据输入域id回写bgys的签名图片")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//        mSql = "select t.user_id, t.cuser_dzqm from icnris_userinfo t where user_id=:user_id";')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//        mDataSet = new uDataSet(new string[] { mSql }, new uParameter[] { new uParameter(":user_id", "081") });')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//        //mDataSet = new uDataSet(new string[] { mSql }, new uParameter[] { new uParameter(":user_id", S_Args1[2]) });')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        if (mDataSet.RowCount() == 0)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            return;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//        LogManager.WriteLog("user_id:" + S_Args1[2]);')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        foreach (DataTable item in mDataSet.Tables)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            foreach (DataRow dr1 in item.Rows) ///遍历所有的行")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                if (!string.IsNullOrEmpty(dr1[1] as String))")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                    //LogManager.WriteLog("电子签名图片:" + dr1[1]);')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        //调用js 根据输入域id设置图片")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token preprocessor property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endregion")]),s._v(" 注释")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br"),n("span",{staticClass:"line-number"},[s._v("93")]),n("br"),n("span",{staticClass:"line-number"},[s._v("94")]),n("br"),n("span",{staticClass:"line-number"},[s._v("95")]),n("br"),n("span",{staticClass:"line-number"},[s._v("96")]),n("br"),n("span",{staticClass:"line-number"},[s._v("97")]),n("br"),n("span",{staticClass:"line-number"},[s._v("98")]),n("br"),n("span",{staticClass:"line-number"},[s._v("99")]),n("br"),n("span",{staticClass:"line-number"},[s._v("100")]),n("br"),n("span",{staticClass:"line-number"},[s._v("101")]),n("br"),n("span",{staticClass:"line-number"},[s._v("102")]),n("br"),n("span",{staticClass:"line-number"},[s._v("103")]),n("br"),n("span",{staticClass:"line-number"},[s._v("104")]),n("br"),n("span",{staticClass:"line-number"},[s._v("105")]),n("br"),n("span",{staticClass:"line-number"},[s._v("106")]),n("br"),n("span",{staticClass:"line-number"},[s._v("107")]),n("br"),n("span",{staticClass:"line-number"},[s._v("108")]),n("br"),n("span",{staticClass:"line-number"},[s._v("109")]),n("br"),n("span",{staticClass:"line-number"},[s._v("110")]),n("br"),n("span",{staticClass:"line-number"},[s._v("111")]),n("br"),n("span",{staticClass:"line-number"},[s._v("112")]),n("br"),n("span",{staticClass:"line-number"},[s._v("113")]),n("br"),n("span",{staticClass:"line-number"},[s._v("114")]),n("br"),n("span",{staticClass:"line-number"},[s._v("115")]),n("br"),n("span",{staticClass:"line-number"},[s._v("116")]),n("br"),n("span",{staticClass:"line-number"},[s._v("117")]),n("br"),n("span",{staticClass:"line-number"},[s._v("118")]),n("br"),n("span",{staticClass:"line-number"},[s._v("119")]),n("br"),n("span",{staticClass:"line-number"},[s._v("120")]),n("br")])]),n("p",[s._v("gbgl_main")]),s._v(" "),n("p",[s._v("监听其他程序发送的消息")]),s._v(" "),n("div",{staticClass:"language-csharp line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-csharp"}},[n("code",[s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/// <summary>")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/// 处理其他窗口调阅过来的信息")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/// </summary>")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('/// <param name="pArg"></param>')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//public override void f_ProcessParams(object pArg)")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//    MessageBox.Show("处理其他窗口发送的消息");')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    var mArg = pArg as Hashtable;")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    if (mArg != null)")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    {")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//        if (mArg["type"].ToString() == "icn_sr")')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//            MessageBox.Show("接收到所见:" + mArg["OpinionStr"] + "结论:" + mArg["ConclusionStr"]);')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//            txt_nr.Text = mArg["OpinionStr"].ToString();')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//            txt_jg.Text = mArg["ConclusionStr"].ToString();')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        else")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            //")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            mUserPicControl.f_Setjc(")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                ((Hashtable)pArg)["accno"].ToString(),')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                ((Hashtable)pArg)["name"].ToString(),')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                ((Hashtable)pArg)["sex"].ToString(),')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                ((Hashtable)pArg)["age"].ToString(),')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                ((Hashtable)pArg)["accno"].ToString(),')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                (uDataSet)((Hashtable)pArg)["ds"]')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                );")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            dockPanel_cj.Show();")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//            dockPanel_cj.Text = "采集:  " + ((Hashtable)pArg)["name"].ToString();')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    }")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br")])]),n("p",[s._v("icn_sr打开报告加载窗体")]),s._v(" "),n("div",{staticClass:"language-csharp line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-csharp"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//ReportMain.f_TemplateLoading();")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//网页加载完成事件")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//uc_sring1.chromeBrowser.FrameLoadEnd += f_ChromeBrowser_FrameLoadEnd;")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//打开报告做的一些事情")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//f_OpenReport();")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[s._v("icn_sr 报告界面")]),s._v(" "),n("div",{staticClass:"language-csharp line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-csharp"}},[n("code",[s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/// <summary>")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/// 鼠标在模板列表组件上方并按下")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/// </summary>")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('/// <param name="sender"></param>')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('/// <param name="e"></param>')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token return-type class-name"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("gc_template_MouseDown")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("object")])]),s._v(" sender"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("MouseEventArgs")]),s._v(" e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token preprocessor property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("region")]),s._v(" 注释")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//PostgreSQLContext context = new PostgreSQLContext(new PostgreSQLConnectionFactory(DBConnectionString.POSTGRE_SQL));")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//try")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    DevExpress.XtraGrid.Views.Grid.ViewInfo.GridHitInfo hInfo = gridView1.CalcHitInfo(new Point(e.X, e.Y));")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    if (e.Button == MouseButtons.Left && e.Clicks == 2)")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        if (hInfo.InRow)")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            // 获取选中行的参数")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            int mSelectRow = gridView1.GetSelectedRows()[0];")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            //模板iid")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//            string mIid = this.gridView1.GetRowCellValue(mSelectRow, "iid").ToString();')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            long mTemplatIid = Convert.ToInt64(mIid);")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            S_TemplateIid = mTemplatIid;")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            var m_q_datatemplat = context.Query<sr_data_templat>();")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            var mGetDataTemplate = m_q_datatemplat.Where(a => a.iid == mTemplatIid)")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                .Select(a => new")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    a.template_data,")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    a.sql")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                }).FirstOrDefault();")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            //加载模板")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            if (!string.IsNullOrEmpty(mGetDataTemplate.template_data))")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                ///TODO")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                //uc_sring1.chromeBrowser.ExecuteScriptAsync("f_load_template(\'" + mGetDataTemplate.template_data + "\');");')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                ///")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                if (uc_Sring != null)")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                    uc_Sring.chromeBrowser.ExecuteScriptAsync("f_load_template(\'" + mGetDataTemplate.template_data + "\');");')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                }")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            }")]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            Thread.Sleep(300);")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            //回写信息")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            if (mGetDataTemplate == null)")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                return;")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            }")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            string mSql = mGetDataTemplate.sql;")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            if (string.IsNullOrEmpty(mSql))")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                return;")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            }")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//            LogManager.WriteLog("传递的sql:" + mSql);')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            //根据模板iid查询回写病人信息的SQL")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            if (S_Args == null)")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                return;")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            }")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            string mParameter = Encoding.Default.GetString(Convert.FromBase64String(S_Args[1]));")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            //解析参数")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            SaveEventParameter mSaveEventReportParameter = new JavaScriptSerializer()")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                 .Deserialize<SaveEventParameter>(mParameter);")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            ExamReportParameter mReport = mSaveEventReportParameter.parameter;")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            //JObject mJobject = JObject.Parse(mParameter);")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            long mExamIid = mReport.exam_iid; //检查表iid")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//            LogManager.WriteLog("mExamIid" + mExamIid);')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//            //string mSql = @"select t.* from icnris_exam t where iid=:iid";')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//            //mSql = "select t.cname as \\"name\\", t.CSEX as \\"sex\\", t.CAGE as \\"age\\" from icnris_exam t where iid=:iid";')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            //mExamIid = 147073;")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//            uDataSet mDataSet = new uDataSet(new string[] { mSql }, new uParameter[] { new uParameter(":iid", mExamIid) }); //147073')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            if (mDataSet.RowCount() == 0)")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                return;")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            }")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            foreach (DataTable dt in mDataSet.Tables)")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                foreach (DataRow dr in dt.Rows) ///遍历所有的行")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    StringBuilder mPatientInformationStr = new StringBuilder(); //拼接病人信息回写数据的json")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                    mPatientInformationStr.Append("{");')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    foreach (DataColumn dc in dt.Columns) //遍历所有的列")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                        mPatientInformationStr.Append("\\"" + dc.ColumnName + "\\":\\"" + dr[dc] + "\\",");')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                        LogManager.WriteLog(dt.TableName + ", " + dc.ColumnName + ", " + dr[dc] + ", "); //表名,列名,单元格数据')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    }")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    if (mPatientInformationStr.Length > 1)")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                        mPatientInformationStr.Remove(mPatientInformationStr.Length - 1, 1); //去除最后一个逗号,")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    }")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                    mPatientInformationStr.Append("}");')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                    LogManager.WriteLog("json数据:" + mPatientInformationStr.ToString());')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                    //调用回写数据的js方法")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                    uc_Sring.chromeBrowser.ExecuteScriptAsync("f_set_data(\'" + mPatientInformationStr + "\');");')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//                }")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            }")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    }")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//catch (Exception ex)")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//    LogManager.WriteLog("双击模板出错:" + ex.Message);')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//finally")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    context.Dispose();")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token preprocessor property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endregion")])]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br"),n("span",{staticClass:"line-number"},[s._v("93")]),n("br"),n("span",{staticClass:"line-number"},[s._v("94")]),n("br"),n("span",{staticClass:"line-number"},[s._v("95")]),n("br"),n("span",{staticClass:"line-number"},[s._v("96")]),n("br"),n("span",{staticClass:"line-number"},[s._v("97")]),n("br"),n("span",{staticClass:"line-number"},[s._v("98")]),n("br"),n("span",{staticClass:"line-number"},[s._v("99")]),n("br"),n("span",{staticClass:"line-number"},[s._v("100")]),n("br"),n("span",{staticClass:"line-number"},[s._v("101")]),n("br"),n("span",{staticClass:"line-number"},[s._v("102")]),n("br"),n("span",{staticClass:"line-number"},[s._v("103")]),n("br"),n("span",{staticClass:"line-number"},[s._v("104")]),n("br"),n("span",{staticClass:"line-number"},[s._v("105")]),n("br"),n("span",{staticClass:"line-number"},[s._v("106")]),n("br"),n("span",{staticClass:"line-number"},[s._v("107")]),n("br"),n("span",{staticClass:"line-number"},[s._v("108")]),n("br"),n("span",{staticClass:"line-number"},[s._v("109")]),n("br"),n("span",{staticClass:"line-number"},[s._v("110")]),n("br")])]),n("div",{staticClass:"language-csharp line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-csharp"}},[n("code",[s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token return-type class-name"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("tree_templat_MouseDown")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("object")])]),s._v(" sender"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("MouseEventArgs")]),s._v(" e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token preprocessor property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("region")]),s._v(" 注释")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//try")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    DevExpress.XtraGrid.Views.Grid.ViewInfo.GridHitInfo hInfo = gridView1.CalcHitInfo(new Point(e.X, e.Y));")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    if (e.Button == MouseButtons.Left && e.Clicks == 2)")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        if (hInfo.InRow)")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            // 获取选中行的参数")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            DevExpress.XtraTreeList.Nodes.TreeListNode mListNode = tree_templat.FocusedNode;")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            //没有子节点")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            if (!mListNode.HasChildren)")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            {")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//                string mIid = mListNode["iid"].ToString();')]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//            }")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        }")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    }")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//catch (Exception ex)")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//    LogManager.WriteLog("双击模板出错:" + ex.Message);')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//finally")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token preprocessor property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endregion")]),s._v(" 注释")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br")])]),n("div",{staticClass:"language-csharp line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-csharp"}},[n("code",[s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/// <summary>")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/// 打开控制台")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/// </summary>")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('/// <param name="sender"></param>')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('/// <param name="e"></param>')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token return-type class-name"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("simpleButton1_Click")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("object")])]),s._v(" sender"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("EventArgs")]),s._v(" e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    uc_sring1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("chromeBrowser"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ShowDevTools")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("p",[s._v("报告界面按按键")]),s._v(" "),n("div",{staticClass:"language-csharp line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-csharp"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//var mkey = e.KeyCode;")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//if (Keys.ControlKey == mkey && Keys.V == mkey)")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//    MessageBox.Show("Ctrl V");')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//ConsoleKeyInfo ki = Console.ReadKey(true);")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//if ((ki.Key == ConsoleKey.V) && (ki.Modifiers == ConsoleModifiers.Control))")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//Console.WriteLine("Ctrl+V pressed");')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//IDataObject iData = Clipboard.GetDataObject();")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//if (iData.GetDataPresent(DataFormats.Bitmap))")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    Image image = (Bitmap)iData.GetData(DataFormats.Bitmap);")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    using (System.IO.MemoryStream memoryStream = new System.IO.MemoryStream())")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    {")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        image.Save(memoryStream, image.RawFormat);")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        byte[] imageBytes = memoryStream.ToArray();")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        string base64Str = Convert.ToBase64String(imageBytes);")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//        base64Str = "data:image/png;base64," + base64Str;')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//        uc_sring1.chromeBrowser.ExecuteScriptAsync("imgClick(\'" + base64Str + "\')");')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    }")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//Console.Write("Press any key to continue . . . ");')]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br")])]),n("p",[s._v("其他方式保存pdf二进制文件")]),s._v(" "),n("div",{staticClass:"language-csharp line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-csharp"}},[n("code",[s._v("\n"),n("span",{pre:!0,attrs:{class:"token preprocessor property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("region")]),s._v(" 注释 其他方式保存文件")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//BASE64Decoder decoder = new BASE64Decoder();")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//BufferedInputStream bis = null;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//FileOutputStream fos = null;")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//BufferedOutputStream bos = null;")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//try")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    byte[] bytes = decoder.decodeBuffer(base64Content);//base64编码内容转换为字节数组")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    ByteArrayInputStream byteInputStream = new ByteArrayInputStream(bytes);")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    bis = new BufferedInputStream(byteInputStream);")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    File file = new File(filePath);")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    File path = file.getParentFile();")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    if (!path.exists())")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        path.mkdirs();")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    fos = new FileOutputStream(file);")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    bos = new BufferedOutputStream(fos);")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    byte[] buffer = new byte[1024];")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    int length = bis.read(buffer);")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    while (length != -1)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    {")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        bos.write(buffer, 0, length);")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//        length = bis.read(buffer);")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    }")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    bos.flush();")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//catch (Exception e)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    e.printStackTrace();")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//finally")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//    closeStream(bis, fos, bos);")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token preprocessor property"}},[s._v("#"),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endregion")])]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br")])]),n("p",[s._v("保存二进制方法文件")]),s._v(" "),n("div",{staticClass:"language-csharp line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-csharp"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//byte[] sPDFDecoded = Convert.FromBase64String(mPdfBase64Str);")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//BinaryWriter writer = new BinaryWriter(File.Open(@"c:\\Users\\Administrator\\Documents\\pdf9.pdf", FileMode.CreateNew));')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//writer.Write(sPDFDecoded);")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("pdf base64字符串在新网页打开时的前缀")]),s._v(" "),n("div",{staticClass:"language-csharp line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-csharp"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//mPdfBase64Str = "data:application/pdf;base64,";')]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])])])}),[],!1,null,null,null);n.default=e.exports}}]);