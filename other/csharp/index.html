<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>csharp | Zichen 文档</title>
    <meta name="generator" content="VuePress 1.9.8">
    <link rel="icon" href="/vuepress/assets/img/favicon.png">
    <meta name="description" content="Zichen">
    
    <link rel="preload" href="/vuepress/assets/css/0.styles.560c966e.css" as="style"><link rel="preload" href="/vuepress/assets/js/app.4f476e97.js" as="script"><link rel="preload" href="/vuepress/assets/js/4.324cc9ea.js" as="script"><link rel="preload" href="/vuepress/assets/js/14.0d54ffe1.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/10.5b3d04c4.js"><link rel="prefetch" href="/vuepress/assets/js/11.2f0c66d8.js"><link rel="prefetch" href="/vuepress/assets/js/12.06f7a9b7.js"><link rel="prefetch" href="/vuepress/assets/js/13.be8292dd.js"><link rel="prefetch" href="/vuepress/assets/js/15.1b40e8cf.js"><link rel="prefetch" href="/vuepress/assets/js/16.7962ea6e.js"><link rel="prefetch" href="/vuepress/assets/js/17.2c2b963d.js"><link rel="prefetch" href="/vuepress/assets/js/18.5e1c2828.js"><link rel="prefetch" href="/vuepress/assets/js/19.2ccf2900.js"><link rel="prefetch" href="/vuepress/assets/js/2.2c4c27eb.js"><link rel="prefetch" href="/vuepress/assets/js/20.b2630050.js"><link rel="prefetch" href="/vuepress/assets/js/21.3555f1db.js"><link rel="prefetch" href="/vuepress/assets/js/22.91a91fea.js"><link rel="prefetch" href="/vuepress/assets/js/23.62f08be4.js"><link rel="prefetch" href="/vuepress/assets/js/24.8967b892.js"><link rel="prefetch" href="/vuepress/assets/js/25.e7d1e6cd.js"><link rel="prefetch" href="/vuepress/assets/js/26.7472d757.js"><link rel="prefetch" href="/vuepress/assets/js/27.406974fe.js"><link rel="prefetch" href="/vuepress/assets/js/28.5fc497be.js"><link rel="prefetch" href="/vuepress/assets/js/29.2422cefc.js"><link rel="prefetch" href="/vuepress/assets/js/3.450450f7.js"><link rel="prefetch" href="/vuepress/assets/js/30.85f93d61.js"><link rel="prefetch" href="/vuepress/assets/js/31.563e60e8.js"><link rel="prefetch" href="/vuepress/assets/js/32.4b768a5d.js"><link rel="prefetch" href="/vuepress/assets/js/33.22efca1d.js"><link rel="prefetch" href="/vuepress/assets/js/34.d7981cf1.js"><link rel="prefetch" href="/vuepress/assets/js/35.e4ad699b.js"><link rel="prefetch" href="/vuepress/assets/js/36.cb65daac.js"><link rel="prefetch" href="/vuepress/assets/js/37.8de365f7.js"><link rel="prefetch" href="/vuepress/assets/js/38.f35c7120.js"><link rel="prefetch" href="/vuepress/assets/js/39.483f0586.js"><link rel="prefetch" href="/vuepress/assets/js/40.810096d2.js"><link rel="prefetch" href="/vuepress/assets/js/41.d23b8102.js"><link rel="prefetch" href="/vuepress/assets/js/42.eff40d27.js"><link rel="prefetch" href="/vuepress/assets/js/43.77a935ce.js"><link rel="prefetch" href="/vuepress/assets/js/44.40d57798.js"><link rel="prefetch" href="/vuepress/assets/js/45.48130280.js"><link rel="prefetch" href="/vuepress/assets/js/46.95f9d54f.js"><link rel="prefetch" href="/vuepress/assets/js/47.9816726f.js"><link rel="prefetch" href="/vuepress/assets/js/48.73ded6c2.js"><link rel="prefetch" href="/vuepress/assets/js/49.6298ed11.js"><link rel="prefetch" href="/vuepress/assets/js/5.154b9ebe.js"><link rel="prefetch" href="/vuepress/assets/js/50.760de1f9.js"><link rel="prefetch" href="/vuepress/assets/js/6.edbfbc38.js"><link rel="prefetch" href="/vuepress/assets/js/7.cc8564f5.js"><link rel="prefetch" href="/vuepress/assets/js/8.afa9c9d0.js"><link rel="prefetch" href="/vuepress/assets/js/9.b292d821.js">
    <link rel="stylesheet" href="/vuepress/assets/css/0.styles.560c966e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vuepress/" class="home-link router-link-active"><img src="/vuepress/hero.png" alt="Zichen 文档" class="logo"> <span class="site-name can-hide">Zichen 文档</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/vuepress/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/vuepress/guide/" class="nav-link">
  目录
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="分类" class="dropdown-title"><span class="title">分类</span> <span class="arrow down"></span></button> <button type="button" aria-label="分类" class="mobile-dropdown-title"><span class="title">分类</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          软件安装
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vuepress/software-installation/apache/" class="nav-link">
  Apache
</a></li><li class="dropdown-subitem"><a href="/vuepress/software-installation/git/" class="nav-link">
  Git
</a></li><li class="dropdown-subitem"><a href="/vuepress/software-installation/mysql/" class="nav-link">
  MySQL
</a></li><li class="dropdown-subitem"><a href="/vuepress/software-installation/php/" class="nav-link">
  PHP
</a></li></ul></li><li class="dropdown-item"><h4>
          语言
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vuepress/language/c/" class="nav-link">
  C
</a></li><li class="dropdown-subitem"><a href="/vuepress/language/csharp/" class="nav-link">
  C#
</a></li><li class="dropdown-subitem"><a href="/vuepress/language/c++/" class="nav-link">
  C++
</a></li><li class="dropdown-subitem"><a href="/vuepress/language/css/" class="nav-link">
  CSS
</a></li><li class="dropdown-subitem"><a href="/vuepress/language/html/" class="nav-link">
  HTML
</a></li><li class="dropdown-subitem"><a href="/vuepress/language/java/" class="nav-link">
  Java
</a></li><li class="dropdown-subitem"><a href="/vuepress/language/js/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-subitem"><a href="/vuepress/language/php/" class="nav-link">
  PHP
</a></li><li class="dropdown-subitem"><a href="/vuepress/language/python/" class="nav-link">
  Python
</a></li><li class="dropdown-subitem"><a href="/vuepress/language/vb/" class="nav-link">
  Visual Basic
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">其他</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress/other/csharp/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  csharp
</a></li><li class="dropdown-item"><!----> <a href="/vuepress/other/read/看书/" class="nav-link">
  看书
</a></li><li class="dropdown-item"><!----> <a href="/vuepress/other/music/听歌/" class="nav-link">
  听歌
</a></li><li class="dropdown-item"><!----> <a href="/vuepress/other/bicycle/骑车/" class="nav-link">
  骑车
</a></li><li class="dropdown-item"><!----> <a href="/vuepress/other/run/跑步/" class="nav-link">
  跑步
</a></li><li class="dropdown-item"><!----> <a href="/vuepress/other/piano/钢琴/" class="nav-link">
  钢琴
</a></li><li class="dropdown-item"><!----> <a href="/vuepress/other/calligraphy/写字/" class="nav-link">
  写字
</a></li><li class="dropdown-item"><!----> <a href="/vuepress/other/badminton/羽毛球/" class="nav-link">
  羽毛球
</a></li><li class="dropdown-item"><!----> <a href="/vuepress/other/scenery/看风景/" class="nav-link">
  看风景
</a></li></ul></div></div><div class="nav-item"><a href="http://zichenlbl.github.io/about" target="_black" rel="noopener noreferrer" class="nav-link external">
  关于我
  <!----></a></div> <a href="https://github.com/zichenlbl/vuepress" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/vuepress/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/vuepress/guide/" class="nav-link">
  目录
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="分类" class="dropdown-title"><span class="title">分类</span> <span class="arrow down"></span></button> <button type="button" aria-label="分类" class="mobile-dropdown-title"><span class="title">分类</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          软件安装
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vuepress/software-installation/apache/" class="nav-link">
  Apache
</a></li><li class="dropdown-subitem"><a href="/vuepress/software-installation/git/" class="nav-link">
  Git
</a></li><li class="dropdown-subitem"><a href="/vuepress/software-installation/mysql/" class="nav-link">
  MySQL
</a></li><li class="dropdown-subitem"><a href="/vuepress/software-installation/php/" class="nav-link">
  PHP
</a></li></ul></li><li class="dropdown-item"><h4>
          语言
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vuepress/language/c/" class="nav-link">
  C
</a></li><li class="dropdown-subitem"><a href="/vuepress/language/csharp/" class="nav-link">
  C#
</a></li><li class="dropdown-subitem"><a href="/vuepress/language/c++/" class="nav-link">
  C++
</a></li><li class="dropdown-subitem"><a href="/vuepress/language/css/" class="nav-link">
  CSS
</a></li><li class="dropdown-subitem"><a href="/vuepress/language/html/" class="nav-link">
  HTML
</a></li><li class="dropdown-subitem"><a href="/vuepress/language/java/" class="nav-link">
  Java
</a></li><li class="dropdown-subitem"><a href="/vuepress/language/js/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-subitem"><a href="/vuepress/language/php/" class="nav-link">
  PHP
</a></li><li class="dropdown-subitem"><a href="/vuepress/language/python/" class="nav-link">
  Python
</a></li><li class="dropdown-subitem"><a href="/vuepress/language/vb/" class="nav-link">
  Visual Basic
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">其他</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress/other/csharp/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  csharp
</a></li><li class="dropdown-item"><!----> <a href="/vuepress/other/read/看书/" class="nav-link">
  看书
</a></li><li class="dropdown-item"><!----> <a href="/vuepress/other/music/听歌/" class="nav-link">
  听歌
</a></li><li class="dropdown-item"><!----> <a href="/vuepress/other/bicycle/骑车/" class="nav-link">
  骑车
</a></li><li class="dropdown-item"><!----> <a href="/vuepress/other/run/跑步/" class="nav-link">
  跑步
</a></li><li class="dropdown-item"><!----> <a href="/vuepress/other/piano/钢琴/" class="nav-link">
  钢琴
</a></li><li class="dropdown-item"><!----> <a href="/vuepress/other/calligraphy/写字/" class="nav-link">
  写字
</a></li><li class="dropdown-item"><!----> <a href="/vuepress/other/badminton/羽毛球/" class="nav-link">
  羽毛球
</a></li><li class="dropdown-item"><!----> <a href="/vuepress/other/scenery/看风景/" class="nav-link">
  看风景
</a></li></ul></div></div><div class="nav-item"><a href="http://zichenlbl.github.io/about" target="_black" rel="noopener noreferrer" class="nav-link external">
  关于我
  <!----></a></div> <a href="https://github.com/zichenlbl/vuepress" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>csharp</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vuepress/other/csharp/#winform" class="sidebar-link">Winform</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuepress/other/csharp/#读取-写入ini配置文件" class="sidebar-link">读取/写入ini配置文件</a></li><li class="sidebar-sub-header"><a href="/vuepress/other/csharp/#按下按键" class="sidebar-link">按下按键</a></li><li class="sidebar-sub-header"><a href="/vuepress/other/csharp/#委托改label文本值" class="sidebar-link">委托改label文本值</a></li><li class="sidebar-sub-header"><a href="/vuepress/other/csharp/#读取pdf转base64" class="sidebar-link">读取pdf转base64</a></li><li class="sidebar-sub-header"><a href="/vuepress/other/csharp/#关闭窗体时取消关闭" class="sidebar-link">关闭窗体时取消关闭</a></li><li class="sidebar-sub-header"><a href="/vuepress/other/csharp/#显示托盘" class="sidebar-link">显示托盘</a></li><li class="sidebar-sub-header"><a href="/vuepress/other/csharp/#在控件上显示提示" class="sidebar-link">在控件上显示提示</a></li><li class="sidebar-sub-header"><a href="/vuepress/other/csharp/#设置状态栏进度条" class="sidebar-link">设置状态栏进度条</a></li><li class="sidebar-sub-header"><a href="/vuepress/other/csharp/#点击托盘退出按钮关闭程序" class="sidebar-link">点击托盘退出按钮关闭程序</a></li><li class="sidebar-sub-header"><a href="/vuepress/other/csharp/#顶部菜单alt快捷键" class="sidebar-link">顶部菜单Alt快捷键</a></li><li class="sidebar-sub-header"><a href="/vuepress/other/csharp/#颜色选择窗体" class="sidebar-link">颜色选择窗体</a></li><li class="sidebar-sub-header"><a href="/vuepress/other/csharp/#在任务栏中显示气球提示" class="sidebar-link">在任务栏中显示气球提示</a></li></ul></li><li><a href="/vuepress/other/csharp/#net-framework" class="sidebar-link">.net framework</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuepress/other/csharp/#文件转base64" class="sidebar-link">文件转base64</a></li><li class="sidebar-sub-header"><a href="/vuepress/other/csharp/#读取xml指定节点的值-遍历子节点" class="sidebar-link">读取xml指定节点的值（遍历子节点）</a></li><li class="sidebar-sub-header"><a href="/vuepress/other/csharp/#读取xml指定节点的值-xpath表达式" class="sidebar-link">读取xml指定节点的值（XPath表达式）</a></li><li class="sidebar-sub-header"><a href="/vuepress/other/csharp/#读取xml指定节点的值-有命名空间" class="sidebar-link">读取xml指定节点的值（有命名空间）</a></li><li class="sidebar-sub-header"><a href="/vuepress/other/csharp/#读取xml相同节点不同属性的值" class="sidebar-link">读取xml相同节点不同属性的值</a></li><li class="sidebar-sub-header"><a href="/vuepress/other/csharp/#读取xml相同节点相同属性的值" class="sidebar-link">读取xml相同节点相同属性的值</a></li><li class="sidebar-sub-header"><a href="/vuepress/other/csharp/#app-manifest" class="sidebar-link">app.manifest</a></li><li class="sidebar-sub-header"><a href="/vuepress/other/csharp/#cpu使用率" class="sidebar-link">cpu使用率</a></li><li class="sidebar-sub-header"><a href="/vuepress/other/csharp/#cpu逻辑处理器数" class="sidebar-link">cpu逻辑处理器数</a></li><li class="sidebar-sub-header"><a href="/vuepress/other/csharp/#ram大小" class="sidebar-link">ram大小</a></li><li class="sidebar-sub-header"><a href="/vuepress/other/csharp/#ram可用大小" class="sidebar-link">ram可用大小</a></li><li class="sidebar-sub-header"><a href="/vuepress/other/csharp/#ram已用大小" class="sidebar-link">ram已用大小</a></li><li class="sidebar-sub-header"><a href="/vuepress/other/csharp/#硬盘信息" class="sidebar-link">硬盘信息</a></li><li class="sidebar-sub-header"><a href="/vuepress/other/csharp/#本地ip地址" class="sidebar-link">本地ip地址</a></li><li class="sidebar-sub-header"><a href="/vuepress/other/csharp/#网卡mac地址" class="sidebar-link">网卡mac地址</a></li><li class="sidebar-sub-header"><a href="/vuepress/other/csharp/#根据生日计算年龄" class="sidebar-link">根据生日计算年龄</a></li><li class="sidebar-sub-header"><a href="/vuepress/other/csharp/#把字符串转为日期类型" class="sidebar-link">把字符串转为日期类型</a></li><li class="sidebar-sub-header"><a href="/vuepress/other/csharp/#datatable添加一行数据" class="sidebar-link">DataTable添加一行数据</a></li><li class="sidebar-sub-header"><a href="/vuepress/other/csharp/#other" class="sidebar-link">Other</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="csharp"><a href="#csharp" class="header-anchor">#</a> csharp</h1> <h2 id="winform"><a href="#winform" class="header-anchor">#</a> Winform</h2> <h3 id="读取-写入ini配置文件"><a href="#读取-写入ini配置文件" class="header-anchor">#</a> 读取/写入ini配置文件</h3> <p>configuration.ini</p> <div class="language-ini line-numbers-mode"><pre class="language-ini"><code><span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">Video</span><span class="token punctuation">]</span></span>
<span class="token key attr-name">Url</span><span class="token punctuation">=</span><span class="token value attr-value">https://www.bilibili.com/video/</span>
<span class="token key attr-name">VideoBVNumber0</span><span class="token punctuation">=</span><span class="token value attr-value">BV19u411e7xa</span>
<span class="token key attr-name">VideoBVNumber1</span><span class="token punctuation">=</span><span class="token value attr-value">BV1wS4y1N7qB</span>
<span class="token key attr-name">VideoBVNumber2</span><span class="token punctuation">=</span><span class="token value attr-value">BV1qc411J7o2</span>
<span class="token key attr-name">VideoBVNumber3</span><span class="token punctuation">=</span><span class="token value attr-value">BV1Mz4y1Y7FX</span>
<span class="token key attr-name">VideoBVNumber4</span><span class="token punctuation">=</span><span class="token value attr-value">BV1rm4y1y7qh</span>
<span class="token key attr-name">VideoBVNumber5</span><span class="token punctuation">=</span><span class="token value attr-value">BV1oc411J7wP</span>
<span class="token key attr-name">VideoBVNumber6</span><span class="token punctuation">=</span><span class="token value attr-value">BV1jP411U7Xu</span>
<span class="token key attr-name">VideoBVNumber7</span><span class="token punctuation">=</span><span class="token value attr-value">BV1Tv4y1J7zk</span>
<span class="token key attr-name">VideoBVNumber8</span><span class="token punctuation">=</span><span class="token value attr-value">BV15c411g7mQ</span>
<span class="token key attr-name">VideoDuration</span><span class="token punctuation">=</span><span class="token value attr-value">5</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>winform读取ini配置的值：</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token comment">// 读取ini文件</span>
<span class="token punctuation">[</span>System<span class="token punctuation">.</span>Runtime<span class="token punctuation">.</span>InteropServices<span class="token punctuation">.</span><span class="token function">DllImport</span><span class="token punctuation">(</span><span class="token string">&quot;kernel32&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">extern</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> <span class="token function">GetPrivateProfileString</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> section<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> key<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> def<span class="token punctuation">,</span> <span class="token class-name">System<span class="token punctuation">.</span>Text<span class="token punctuation">.</span>StringBuilder</span> retVal<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> size<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 写入ini文件</span>
<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">System<span class="token punctuation">.</span>Runtime<span class="token punctuation">.</span>InteropServices<span class="token punctuation">.</span>DllImport</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;kernel32&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">extern</span> <span class="token return-type class-name"><span class="token keyword">long</span></span> <span class="token function">WritePrivateProfileString</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> section<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> key<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> val<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">button_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name">StringBuilder</span> temp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 读取，读取到的长度</span>
    <span class="token class-name"><span class="token keyword">int</span></span> bilibiliUrlLength <span class="token operator">=</span> <span class="token function">GetPrivateProfileString</span><span class="token punctuation">(</span><span class="token string">&quot;Video&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Url&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> temp<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> Application<span class="token punctuation">.</span>StartupPath <span class="token operator">+</span> <span class="token string">&quot;\\configuration.ini&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 没读取到</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>bilibiliUrlLength <span class="token operator">&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// 写入空值，1:true，0:false</span>
        <span class="token class-name"><span class="token keyword">long</span></span> result <span class="token operator">=</span> <span class="token function">WritePrivateProfileString</span><span class="token punctuation">(</span><span class="token string">&quot;Video&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Url&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> Application<span class="token punctuation">.</span>StartupPath <span class="token operator">+</span> <span class="token string">&quot;\\configuration.ini&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>temp<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="按下按键"><a href="#按下按键" class="header-anchor">#</a> 按下按键</h3> <p>winform按下键盘上指定的键</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">System<span class="token punctuation">.</span>Runtime<span class="token punctuation">.</span>InteropServices<span class="token punctuation">.</span>DllImport</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;user32.dll&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">extern</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">keybd_event</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">byte</span></span> bVk<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">byte</span></span> bScan<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> dwFlags<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> dwExtraInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">System<span class="token punctuation">.</span>Runtime<span class="token punctuation">.</span>InteropServices<span class="token punctuation">.</span>DllImport</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;user32.dll&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">extern</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">keybd_event</span><span class="token punctuation">(</span><span class="token class-name">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>Keys</span> key<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> scanCode<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">uint</span></span> flags<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> extraInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">button_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// 释放键标志位</span>
    <span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">int</span></span> KEYEVENTF_KEYUP <span class="token operator">=</span> <span class="token number">0x0002</span><span class="token punctuation">;</span> 
    <span class="token comment">// 49对应键盘1</span>
    <span class="token class-name"><span class="token keyword">byte</span></span> key <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span><span class="token number">49</span><span class="token punctuation">;</span>

    <span class="token comment">// 按下Ctrl</span>
    <span class="token function">keybd_event</span><span class="token punctuation">(</span>Keys<span class="token punctuation">.</span>ControlKey<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 按下1</span>
    <span class="token function">keybd_event</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 松开Ctrl</span>
    <span class="token function">keybd_event</span><span class="token punctuation">(</span>Keys<span class="token punctuation">.</span>ControlKey<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> KEYEVENTF_KEYUP<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 松开1</span>
    <span class="token function">keybd_event</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> KEYEVENTF_KEYUP<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h3 id="委托改label文本值"><a href="#委托改label文本值" class="header-anchor">#</a> 委托改label文本值</h3> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// 追加textbox文字方法</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token comment">/// &lt;param name=&quot;log&quot;&gt;&lt;/param&gt;</span>
<span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">SetLogTextAdd</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> log<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    textBox1<span class="token punctuation">.</span>Text <span class="token operator">+=</span> log<span class="token punctuation">;</span>
    <span class="token comment">// 选定文本的起始点</span>
    textBox1<span class="token punctuation">.</span>SelectionStart <span class="token operator">=</span> textBox1<span class="token punctuation">.</span>Text<span class="token punctuation">.</span>Length<span class="token punctuation">;</span>
    <span class="token comment">// 设置文本框中选定的字符数</span>
    textBox1<span class="token punctuation">.</span>SelectionLength <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token comment">// 滚动到当前插入字符的位置</span>
    textBox1<span class="token punctuation">.</span><span class="token function">ScrollToCaret</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// 设置textbox文字委托</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token comment">/// &lt;param name=&quot;str&quot;&gt;&lt;/param&gt;</span>
<span class="token keyword">public</span> <span class="token keyword">delegate</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">SetLogTextDelegate</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 点击按钮修改textBox1的内容</span>
<span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">button3_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name">SetLogTextDelegate</span> setLogText <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SetLogTextDelegate</span><span class="token punctuation">(</span>SetLogTextAdd<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>textBox1<span class="token punctuation">.</span>InvokeRequired<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        textBox1<span class="token punctuation">.</span><span class="token function">Invoke</span><span class="token punctuation">(</span>setLogText<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">object</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> <span class="token punctuation">{</span> <span class="token string">&quot;\r\n准备运行&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{</span>
        textBox1<span class="token punctuation">.</span>Text <span class="token operator">+=</span> <span class="token string">&quot;\r\n准备运行&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><h3 id="读取pdf转base64"><a href="#读取pdf转base64" class="header-anchor">#</a> 读取pdf转base64</h3> <p>pdf文件：测试读取pdf转base64.pdf</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token comment">//测试读取pdf转</span>
<span class="token class-name"><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> mBytes <span class="token operator">=</span> System<span class="token punctuation">.</span>IO<span class="token punctuation">.</span>File<span class="token punctuation">.</span><span class="token function">ReadAllBytes</span><span class="token punctuation">(</span><span class="token string">&quot;测试读取pdf转base64.pdf&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">string</span></span> mBase64String <span class="token operator">=</span> Convert<span class="token punctuation">.</span><span class="token function">ToBase64String</span><span class="token punctuation">(</span>mBytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>mBase64String<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="关闭窗体时取消关闭"><a href="#关闭窗体时取消关闭" class="header-anchor">#</a> 关闭窗体时取消关闭</h3> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// 窗体关闭确认前事件</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token comment">/// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;</span>
<span class="token comment">/// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;</span>
<span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Form1_FormClosing</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">FormClosingEventArgs</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// 取消关闭事件</span>
    e<span class="token punctuation">.</span>Cancel <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token comment">// 最小化窗口</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>WindowState <span class="token operator">=</span> FormWindowState<span class="token punctuation">.</span>Minimized<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="显示托盘"><a href="#显示托盘" class="header-anchor">#</a> 显示托盘</h3> <p>往窗体上拖一个notifyIcon1组件，然后设置notifyIcon1属性的Icon图标，然后运行窗体，就在托盘显示图标了。</p> <h3 id="在控件上显示提示"><a href="#在控件上显示提示" class="header-anchor">#</a> 在控件上显示提示</h3> <p>往窗体上拖一个toolTip1组件，然后在按钮的鼠标移入事件中写代码：</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">button1_MouseEnter</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    toolTip1<span class="token punctuation">.</span><span class="token function">SetToolTip</span><span class="token punctuation">(</span>button1<span class="token punctuation">,</span> <span class="token string">&quot;我是按钮&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="设置状态栏进度条"><a href="#设置状态栏进度条" class="header-anchor">#</a> 设置状态栏进度条</h3> <p>新建TaskbarProgress类。</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">TaskbarProgress</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">TaskbarStates</span>
    <span class="token punctuation">{</span>
        NoProgress <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
        Indeterminate <span class="token operator">=</span> <span class="token number">0x1</span><span class="token punctuation">,</span>
        Normal <span class="token operator">=</span> <span class="token number">0x2</span><span class="token punctuation">,</span>
        Error <span class="token operator">=</span> <span class="token number">0x4</span><span class="token punctuation">,</span>
        Paused <span class="token operator">=</span> <span class="token number">0x8</span>
    <span class="token punctuation">}</span>

    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ComImport</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Guid</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;ea1afb91-9e28-4b86-90e9-9e9f8a5eefaf&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">InterfaceType</span><span class="token attribute-arguments"><span class="token punctuation">(</span>ComInterfaceType<span class="token punctuation">.</span>InterfaceIsIUnknown<span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token keyword">private</span> <span class="token keyword">interface</span> <span class="token class-name">ITaskbarList3</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// ITaskbarList</span>
        <span class="token punctuation">[</span>PreserveSig<span class="token punctuation">]</span>
        <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">HrInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">PreserveSig</span></span><span class="token punctuation">]</span>
        <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">AddTab</span><span class="token punctuation">(</span><span class="token class-name">IntPtr</span> hwnd<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">PreserveSig</span></span><span class="token punctuation">]</span>
        <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">DeleteTab</span><span class="token punctuation">(</span><span class="token class-name">IntPtr</span> hwnd<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">PreserveSig</span></span><span class="token punctuation">]</span>
        <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">ActivateTab</span><span class="token punctuation">(</span><span class="token class-name">IntPtr</span> hwnd<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">PreserveSig</span></span><span class="token punctuation">]</span>
        <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">SetActiveAlt</span><span class="token punctuation">(</span><span class="token class-name">IntPtr</span> hwnd<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// ITaskbarList2</span>
        <span class="token punctuation">[</span>PreserveSig<span class="token punctuation">]</span>
        <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">MarkFullscreenWindow</span><span class="token punctuation">(</span><span class="token class-name">IntPtr</span> hwnd<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">MarshalAs</span><span class="token attribute-arguments"><span class="token punctuation">(</span>UnmanagedType<span class="token punctuation">.</span>Bool<span class="token punctuation">)</span></span></span><span class="token punctuation">]</span> <span class="token class-name"><span class="token keyword">bool</span></span> fFullscreen<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// ITaskbarList3</span>
        <span class="token punctuation">[</span>PreserveSig<span class="token punctuation">]</span>
        <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">SetProgressValue</span><span class="token punctuation">(</span><span class="token class-name">IntPtr</span> hwnd<span class="token punctuation">,</span> <span class="token class-name">UInt64</span> ullCompleted<span class="token punctuation">,</span> <span class="token class-name">UInt64</span> ullTotal<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">PreserveSig</span></span><span class="token punctuation">]</span>
        <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">SetProgressState</span><span class="token punctuation">(</span><span class="token class-name">IntPtr</span> hwnd<span class="token punctuation">,</span> <span class="token class-name">TaskbarStates</span> state<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ComImport</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Guid</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;56fdf344-fd6d-11d0-958a-006097c9a090&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ClassInterface</span><span class="token attribute-arguments"><span class="token punctuation">(</span>ClassInterfaceType<span class="token punctuation">.</span>None<span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token keyword">private</span> <span class="token keyword">class</span> <span class="token class-name">TaskbarInstance</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">ITaskbarList3</span> taskbarInstance <span class="token operator">=</span> <span class="token punctuation">(</span>ITaskbarList3<span class="token punctuation">)</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">TaskbarInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name"><span class="token keyword">bool</span></span> taskbarSupported <span class="token operator">=</span> Environment<span class="token punctuation">.</span>OSVersion<span class="token punctuation">.</span>Version <span class="token operator">&gt;=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Version</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">SetState</span><span class="token punctuation">(</span><span class="token class-name">IntPtr</span> windowHandle<span class="token punctuation">,</span> <span class="token class-name">TaskbarStates</span> taskbarState<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>taskbarSupported<span class="token punctuation">)</span> taskbarInstance<span class="token punctuation">.</span><span class="token function">SetProgressState</span><span class="token punctuation">(</span>windowHandle<span class="token punctuation">,</span> taskbarState<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">SetValue</span><span class="token punctuation">(</span><span class="token class-name">IntPtr</span> windowHandle<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">double</span></span> progressValue<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">double</span></span> progressMax<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>taskbarSupported<span class="token punctuation">)</span> taskbarInstance<span class="token punctuation">.</span><span class="token function">SetProgressValue</span><span class="token punctuation">(</span>windowHandle<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">ulong</span><span class="token punctuation">)</span>progressValue<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">ulong</span><span class="token punctuation">)</span>progressMax<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br></div></div><p>使用。</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code>TaskbarProgress<span class="token punctuation">.</span><span class="token function">SetValue</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Handle<span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置50%进度条</span>
TaskbarProgress<span class="token punctuation">.</span><span class="token function">SetState</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>Handle<span class="token punctuation">,</span> TaskbarProgress<span class="token punctuation">.</span>TaskbarStates<span class="token punctuation">.</span>Paused<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置状态为Paused</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="点击托盘退出按钮关闭程序"><a href="#点击托盘退出按钮关闭程序" class="header-anchor">#</a> 点击托盘退出按钮关闭程序</h3> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">private</span> <span class="token keyword">void</span> 退出<span class="token function">ToolStripMenuItem_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// 终止此进程，并为基础操作系统提供指定的退出代码。</span>
    Environment<span class="token punctuation">.</span><span class="token function">Exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 该方法会通知所有消息泵必须终止，如果存在托管线程（非主线程），也无法干净退出</span>
    <span class="token comment">//Application.Exit();</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="顶部菜单alt快捷键"><a href="#顶部菜单alt快捷键" class="header-anchor">#</a> 顶部菜单Alt快捷键</h3> <p>menuStrip1组件</p> <p>ToolStripMenuItem的Text属性设置为：</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code>文件(&amp;F)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>按alt键，然后按F键就打开菜单文件。</p> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPYAAAAmCAYAAAD3LGbnAAAKKklEQVR4nO2dT08iaR7HP73pGwp93Su2saMbDXOoeFZhejLTB5G9i8lMpyGClxV8BQinxg5MZnYCvgAaD9pJT1Xr2dRhiGRx7dDFYbMvQPlz3d5DAVZBoaBot8zzSZ5EiqeqHp6nvs/vz/OkfFT6z/lnBALBSPH40aNHX7oNAoFgyDxG6FogGDkePxLKFghGjsetP/469r9bXehLufR/tlDiS/5eMcb3wzB+71+G0A6BQPCVIYQtEIwgQtgCwQgihC0QjCBC2ALBCDJUYSthBw5HGGWA+u50xeoLHO40Ft98ZWikl5ZIa8ZjMmF765jx7z6Qw9jt9ivLolV/fc1UUiyMhZC7jo0xZigLqX5/l0Zq0ca6fH3NPzNDFbY7eUFudRdfX6JUONiVWH7uBKCSdg8g5gpptwNHWJ9CtPSSpQjCMshhO/alNP1qazAmCGzOEH1puL78jqzk5duJq8+UwxbtJUm1Wm2WHH7An6sajlU5DDgNV6mQXhxnPNQxlSohxsfHTaVzQlBC44wv3tHkKYcuRTsbQSWDty3ilsjXyNfr1Ot51pBY+e7yd1VSCybR22w2bAMpWRd/6xwttYjNto71FWTWbTYWU/oIyus2bIupO3pe7o8bCLvCz54nPHliLg6HA4fDgW8XULdwNT+bilG4ygG70jJNXaN9VFndDODscVdTC9Iv2SJGIek2HPWTq5pFkPSAJ1lgmygv+zabA+IJsU2UHRlAI53IghrFZbdjt/vIohJ1GQUcRgY8Sb2NOT9I24V2e9vI78hK24Q81rcFqKR/JEKck51WPzSF7i0RP6lRq7VKnpnInEnI7p0T4kT48S48AM8O9XpdL8U4UlvEder1HS5/UoXUgpd/xX8j2Dnwa/n2NYqJ+YFur6V+YpMExTdXdF6vpr8pkmCTn1IPW9o3ELaTV/I55+fnnJ//QUySiP1xzsXFRXfJrQKr5FqflZZwK6QTu0jLz5ufFQ52YdfXnAB8u12TQ7htlBSSW/1PArpV9aNGd3rM2LdFv372nQzyDlHVOMHk8COxXTBOOEl6P24y4dYE4DNOEM2yZLSwCq8jKv7oZT9U0j8SUf3ka4eYDDtudmp5/GqEubZ1dxKI+lEjr/sOnfqnQmrB2mKbXW4nwaMiK29nGQtdPzq65Z1l8xgyyzbdkttsHdZY5vXmMWuRINc4TT2YIBhZ43jz9R09L/fDLV1xJ0+nVfZ+t571lYNdWP0Bd9cXSbbUy4+VdILd1Zx5QpBiFAyTRNs4KwfsSjHCXRe9Ak+IbSnLu7saKU+Squ4eXCPcfuicCJol5zdXU/bJSnE22v2gC12Kb3T3NwBuNuISZPcvhezeIC5l2R+6sp0EjwwWW4pTbFrfoy7T7CT4Wxwps41J8xlv2xWf3TwGYCJ4SKNRJDE/T6LYoNFo0CgmMNlzeZ/MfIKN2wyCZ4PEfIb9B6zsW8fY7lAMtnYsZn09ho51KVC31sZ6yS0s6lmjHOzC9GSf1rrFBE9n0K3qELmMk5dIaxrppc642coVt2MP99cOOWxnqUcIoexnYcbQD5UyJSRWnvfuGefzFSRKlNsCcjI5A9khK9sUI89GUNUIs10xNpRb9WYjqPyNSWPTe7riGmfHHTecf9a2zvJ+BqYnb2itW0wwOQ2ZB6zs2yfPnK/4x+ouiY5YTbfCmx0u4WV8HFttHShzaoi1r6ZC+RSkKathy+Kzd8eyLTzf+6H0aahJET1O1pNcMEHgQ9O6FraR2jG/hTuevJ1NhwrlEkjPDP2gnaH2PsGAypmhE9wv/FAqDzWJ5gweUa/Xya8BBmvdGWNPNut1x94DoJ1xqXON8inMP7N6PjIs24zue6ssk7Go7XmxBqflB5tEG0pWXLfaL2lrWwnj2poml+y2wtpHiP0SYLJ1wBlAUfqNl3WmJ61qdybPLFxi9eP9DZQ0dUurcT0zxn6YeIbU11kSXc+9ejbcfmkuZx38UKd+FDSMrUxobIEUQY6uE7KFKw6AVuaUaSav6Nxpyy/X2Gs03XdT2WOt14WOh9wv98hwlrucr1By02y53KSVNG7fKbFC0jLWcycVsxVXwt3Zc4vk2cNY19aRd6KoM08tha2ll/p0xTU+lWDmaZ/Tg3OSGVTevu/dS5X3b1GZwXJeHCbOIEf1Ohtl87LV2JiXDCqRWfMa9thCqntse7ni2hnHBtdbYM3w1rHdSQox2PJtQeyXLhf8qvMss+kdybMLg1U/Ld9Q4nduRfU425f1k+vhbmsf1a5QQo26sNvtLKU/GSr+Tl6VsIw6mpRM/eDmhZ8rstxXJNekOxSKQaCtNet40eCa53vaS0u08inz3ufm9nbE1KflIdnZBzyBPL6+Sh9Ufsb9zRaqFKNwsUnS4cKxJRErKP0LvC+cTE6D+lGDAdNn2qcSzHw//IHSPlECpgA57CLKNoVqwHAfD9/7ffhcdqKAnvWeQA7b8WVBDyEMYUMggL7sFQW/n7zLTrRZp+qh+VoMPemlnpn7wb1zQrw0h3cc8rUdg4AVQuNeslKck44BqZRLMPNiwN68D8qkFrxE2omDZWyssZYBb/Gyd7XyKfCi+UlPeh2faXDLkdbKpzD94sEK+1YWu/KzR9+g8s1HNttW1U3y4oKLwjJ7Lt2Nttw2ekPcP6zC6aDJHo3f892W8rZo6SXsrjzenJe8a4lPoSrVD4Guh6G1GUUvHwhMGI+ZcwH6Ljofpe0CH5JJPlSrVHPgs5sz5NZJLyeBwxon8RJe084zL+Rr1A47cxkV3r9VzUm4e0IONd1wbwZp5bt2u+TQGLMRFTJv4Tfdqrdj4UyG08SvBE05Q3OKfDhJL433+eMeSbiHwaN//7f6GQZ7g4qy8YS/74IU+wP5lT4kV731QQk3d6St5rhoJtSUsIPEVAHFyqQrYRyJKQqWSTWFsMMHOX1tu6+3TWhpllwf2bz1GrMZObzEp5AuVN0NdxHtJzXtz3VnxuWwvinF6jsur59fOWluK9WtMPkaO4Os6RuppFmcOyNqsu69uf2bPWRCY9tMFY+6d5pdc1953Ub8WZHD4ATI69iWW7nseRLFQ4PYZdZty7DX4AYbz3S0FIuzZ0Qab4b6vPTLMN6gciNh31Vj+qWSduPaW6agBHA5HFfWrVaryGE7iakCHwIPdwZuYeznSnqRubcrnBwGmBsfH+g6tVoNJTTO9rOTjv3n/d37Phn0vlpqkdm8l+JhkFmbbaBzG42GeRL5Agyjn4cTY98zzsAvxPZcuMKTVKvVK+vKYTu+0jaF5MMXdSfOwD+Jv51jLjRJrVYb6FwlNI63FOdk5+uLrm/LRPBXEvlZZtcnaTQaA50rr9tYPk1QfPOwn5cHabG/hvt+KcTLDEcf8TJDgUBgiRC2QDCCDC3G/vz5y/wLsC91X4Hga0ZYbIFgBBHCFghGECFsgWAEEcIWCEYQIWyBYAQRwhYIRhAhbIFgBBHCFghGECFsgWAE+T8qO8qBOk9PtwAAAABJRU5ErkJggg==" alt="image-20230720152210462"></p> <h3 id="颜色选择窗体"><a href="#颜色选择窗体" class="header-anchor">#</a> 颜色选择窗体</h3> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token class-name">ColorDialog</span> cd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ColorDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cd<span class="token punctuation">.</span><span class="token function">ShowDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="在任务栏中显示气球提示"><a href="#在任务栏中显示气球提示" class="header-anchor">#</a> 在任务栏中显示气球提示</h3> <p>往窗体上拖一个notifyIcon1组件，然后在代码中写：</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token function">Form1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">InitializeComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>notifyIcon1<span class="token punctuation">.</span><span class="token function">ShowBalloonTip</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span> <span class="token string">&quot;标题&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;内容&quot;</span><span class="token punctuation">,</span> ToolTipIcon<span class="token punctuation">.</span>Info<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//显示气泡提示</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="net-framework"><a href="#net-framework" class="header-anchor">#</a> .net framework</h2> <h3 id="文件转base64"><a href="#文件转base64" class="header-anchor">#</a> 文件转base64</h3> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token comment">//测试读取pdf转base64</span>
<span class="token class-name"><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> mBytes <span class="token operator">=</span> System<span class="token punctuation">.</span>IO<span class="token punctuation">.</span>File<span class="token punctuation">.</span><span class="token function">ReadAllBytes</span><span class="token punctuation">(</span><span class="token string">&quot;测试读取pdf转base64.pdf&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">string</span></span> mBase64String <span class="token operator">=</span> Convert<span class="token punctuation">.</span><span class="token function">ToBase64String</span><span class="token punctuation">(</span>mBytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>mBase64String<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="读取xml指定节点的值-遍历子节点"><a href="#读取xml指定节点的值-遍历子节点" class="header-anchor">#</a> 读取xml指定节点的值（遍历子节点）</h3> <p>XMLFIle2.xml：</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>root</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>messageHeader</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>msgSource</span><span class="token punctuation">&gt;</span></span>发送系统<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>msgSource</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sender</span><span class="token punctuation">&gt;</span></span>发送者<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>sender</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>receiver</span><span class="token punctuation">&gt;</span></span>UnionntPLMR<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>receiver</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sendTime</span><span class="token punctuation">&gt;</span></span>发送时间<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>sendTime</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>msgType</span><span class="token punctuation">&gt;</span></span>病案状态<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>msgType</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>msgCode</span><span class="token punctuation">&gt;</span></span>S034<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>msgCode</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>msgId</span><span class="token punctuation">&gt;</span></span>通知主键<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>msgId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>messageHeader</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>messageBody</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>patientNo</span><span class="token punctuation">&gt;</span></span>住院唯一标识<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>patientNo</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>districtCode</span><span class="token punctuation">&gt;</span></span>院区标识<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>districtCode</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span><span class="token punctuation">&gt;</span></span>结果（1/2）<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>result</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scode</span><span class="token punctuation">&gt;</span></span>状态编码（01/02/03……）<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scode</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sname</span><span class="token punctuation">&gt;</span></span>状态名称<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>sname</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>messageBody</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>root</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>代码读取：</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token class-name">System<span class="token punctuation">.</span>Xml<span class="token punctuation">.</span>XmlDocument</span> doc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Xml<span class="token punctuation">.</span>XmlDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
doc<span class="token punctuation">.</span><span class="token function">Load</span><span class="token punctuation">(</span><span class="token string">&quot;XMLFIle2.xml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System<span class="token punctuation">.</span>Xml<span class="token punctuation">.</span>XmlNode</span> root <span class="token operator">=</span> doc<span class="token punctuation">.</span>DocumentElement<span class="token punctuation">;</span>
<span class="token comment">// 读取根节点&lt;root&gt;下的子节点</span>
<span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name">System<span class="token punctuation">.</span>Xml<span class="token punctuation">.</span>XmlNode</span> node <span class="token keyword">in</span> root<span class="token punctuation">.</span>ChildNodes<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// 处理子节点</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>Name <span class="token operator">==</span> <span class="token string">&quot;messageBody&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> a <span class="token operator">=</span> node<span class="token punctuation">.</span>ChildNodes<span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> a<span class="token punctuation">.</span>Count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Name <span class="token operator">==</span> <span class="token string">&quot;scode&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>InnerText<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 状态编码（01/02/03……）</span>
                <span class="token comment">/*
                // scode节点下还有子节点的话，通过这样获取
                for (int j = 0; j &lt; a[i].ChildNodes.Count; j++)
                {
                    if (a[i].ChildNodes[j].Name == &quot;staffName&quot;)
                    {
                        Console.WriteLine(a[i].ChildNodes[j].InnerText);
                    }
                }
                */</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h3 id="读取xml指定节点的值-xpath表达式"><a href="#读取xml指定节点的值-xpath表达式" class="header-anchor">#</a> 读取xml指定节点的值（XPath表达式）</h3> <p>XMLFile3.xml</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>root</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">root</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2.16.156.10011.2.5.1.1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">extension</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>b7722265-cc05-4b72-b3ed-fe54b30a34c4<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token comment">&lt;!--@value消息发送时间--&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>creationTime</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>20210108153405<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>interactionId</span> <span class="token attr-name">root</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2.16.156.10011.2.5.1.2<span class="token punctuation">&quot;</span></span> <span class="token attr-name">extension</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>POOR_IN200901UV<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>processingCode</span> <span class="token attr-name">code</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>P<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>processingModeCode</span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>acceptAckCode</span> <span class="token attr-name">code</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>AL<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>receiver</span> <span class="token attr-name">typeCode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>RCV<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>device</span> <span class="token attr-name">classCode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>DEV<span class="token punctuation">&quot;</span></span> <span class="token attr-name">determinerCode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>INSTANCE<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!--@extension接受者ID,root为固定值--&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span> <span class="token attr-name">root</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2.16.156.10011.2.5.1.3<span class="token punctuation">&quot;</span></span> <span class="token attr-name">extension</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ECG<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span> <span class="token attr-name">root</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2.16.156.10011.2.5.1.4<span class="token punctuation">&quot;</span></span> <span class="token attr-name">extension</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ECG1<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>device</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>receiver</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>root</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>代码读取：</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token class-name">XmlDocument</span> xml <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">XmlDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//实例化这个类</span>
<span class="token class-name"><span class="token keyword">string</span></span> path <span class="token operator">=</span> <span class="token string">@&quot;XMLFile3.xml&quot;</span><span class="token punctuation">;</span>
xml<span class="token punctuation">.</span><span class="token function">Load</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">string</span></span> xmltxt <span class="token operator">=</span> xml<span class="token punctuation">.</span>InnerXml<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取xml文本</span>
<span class="token class-name">XmlDocument</span> doc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">XmlDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//重新实例化一个XmlDocument用来加载xml文本</span>
doc<span class="token punctuation">.</span><span class="token function">LoadXml</span><span class="token punctuation">(</span>xmltxt<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//GetElementsByTagName用来指定获取那个节点内容，会返回节点List集合</span>
<span class="token class-name">XmlNodeList</span> xnList <span class="token operator">=</span> doc<span class="token punctuation">.</span>DocumentElement<span class="token punctuation">.</span><span class="token function">GetElementsByTagName</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">XmlNode</span> xmlNode <span class="token operator">=</span> doc<span class="token punctuation">.</span><span class="token function">SelectSingleNode</span><span class="token punctuation">(</span><span class="token string">&quot;root/receiver/device/id/item[@root='2.16.156.10011.2.5.1.4']&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>xmlNode <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>xmlNode<span class="token punctuation">.</span>Attributes<span class="token punctuation">[</span><span class="token string">&quot;extension&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ECG1</span>
<span class="token punctuation">}</span>
<span class="token comment">//通过这个集合下标的Attributes获取对应属性的值</span>
<span class="token comment">// b7722265-cc05-4b72-b3ed-fe54b30a34c4</span>
Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>xnList<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Attributes<span class="token punctuation">[</span><span class="token string">&quot;extension&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="读取xml指定节点的值-有命名空间"><a href="#读取xml指定节点的值-有命名空间" class="header-anchor">#</a> 读取xml指定节点的值（有命名空间）</h3> <p>XMLFile4.xml</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bookstore</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://example.books.com<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>book</span> <span class="token attr-name">genre</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>autobiography<span class="token punctuation">&quot;</span></span> <span class="token attr-name">publicationdate</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1991<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ISBN</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1-861003-11-0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>The Autobiography of Benjamin Franklin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>author</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>first-name</span><span class="token punctuation">&gt;</span></span>Benjamin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>first-name</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>last-name</span><span class="token punctuation">&gt;</span></span>Franklin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>last-name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>author</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>price</span><span class="token punctuation">&gt;</span></span>8.99<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>price</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>book</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">sp:</span>book</span> <span class="token attr-name">genre</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>novel<span class="token punctuation">&quot;</span></span> <span class="token attr-name">publicationdate</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1967<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ISBN</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0-201-63361-2<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>sp</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://example.book.org<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>The Confidence Man<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>author</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>first-name</span><span class="token punctuation">&gt;</span></span>Herman<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>first-name</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>last-name</span><span class="token punctuation">&gt;</span></span>Melville<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>last-name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>author</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>price</span><span class="token punctuation">&gt;</span></span>11.99<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>price</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">sp:</span>book</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>book</span> <span class="token attr-name">genre</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>philosophy<span class="token punctuation">&quot;</span></span> <span class="token attr-name">publicationdate</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1991<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ISBN</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1-861001-57-6<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>The Gorgias<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>author</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>Plato<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>author</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>price</span><span class="token punctuation">&gt;</span></span>9.99<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>price</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>book</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bookstore</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>代码读取：</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token class-name">XmlDocument</span> xmldoc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">XmlDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xmldoc<span class="token punctuation">.</span><span class="token function">Load</span><span class="token punctuation">(</span><span class="token string">@&quot;XMLFile4.xml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">XmlNamespaceManager</span> xmlns <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">XmlNamespaceManager</span><span class="token punctuation">(</span>xmldoc<span class="token punctuation">.</span>NameTable<span class="token punctuation">)</span><span class="token punctuation">;</span>
xmlns<span class="token punctuation">.</span><span class="token function">AddNamespace</span><span class="token punctuation">(</span><span class="token string">&quot;sd&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;http://example.books.com&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 默认的命名空间也要添加前缀</span>
xmlns<span class="token punctuation">.</span><span class="token function">AddNamespace</span><span class="token punctuation">(</span><span class="token string">&quot;sp&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;http://example.book.org&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">XmlNode</span> title <span class="token operator">=</span> xmldoc<span class="token punctuation">.</span><span class="token function">SelectSingleNode</span><span class="token punctuation">(</span><span class="token string">&quot;/sd:bookstore/sp:book/sd:title&quot;</span><span class="token punctuation">,</span> xmlns<span class="token punctuation">)</span><span class="token punctuation">;</span>
Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>title<span class="token punctuation">.</span>InnerText<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// The Confidence Man</span>
Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>xmldoc<span class="token punctuation">.</span><span class="token function">SelectSingleNode</span><span class="token punctuation">(</span><span class="token string">&quot;/sd:bookstore/sd:book[@genre='philosophy']/sd:title&quot;</span><span class="token punctuation">,</span> xmlns<span class="token punctuation">)</span><span class="token punctuation">.</span>InnerText<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// The Gorgias</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="读取xml相同节点不同属性的值"><a href="#读取xml相同节点不同属性的值" class="header-anchor">#</a> 读取xml相同节点不同属性的值</h3> <p>last-name节点相同，type不同。</p> <p>XMLFile5.xml</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bookstore</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://example.books.com<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>book</span> <span class="token attr-name">genre</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>autobiography<span class="token punctuation">&quot;</span></span> <span class="token attr-name">publicationdate</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1991<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ISBN</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1-861003-11-0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>The Autobiography of Benjamin Franklin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>author</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>first-name</span><span class="token punctuation">&gt;</span></span>Benjamin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>first-name</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>last-name</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>SAL<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Franklin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>last-name</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>last-name</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>SAL2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Franklin2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>last-name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>author</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>price</span><span class="token punctuation">&gt;</span></span>8.99<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>price</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>book</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bookstore</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>代码读取：</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token class-name">XmlDocument</span> xmldoc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">XmlDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xmldoc<span class="token punctuation">.</span><span class="token function">Load</span><span class="token punctuation">(</span><span class="token string">@&quot;XMLFile5.xml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">XmlNamespaceManager</span> xmlns <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">XmlNamespaceManager</span><span class="token punctuation">(</span>xmldoc<span class="token punctuation">.</span>NameTable<span class="token punctuation">)</span><span class="token punctuation">;</span>
xmlns<span class="token punctuation">.</span><span class="token function">AddNamespace</span><span class="token punctuation">(</span><span class="token string">&quot;sd&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;http://example.books.com&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//默认的命名空间也要添加 前缀</span>
<span class="token class-name">XmlNode</span> title <span class="token operator">=</span> xmldoc<span class="token punctuation">.</span><span class="token function">SelectSingleNode</span><span class="token punctuation">(</span><span class="token string">&quot;/sd:bookstore/sd:book/sd:author/sd:last-name[@type='SAL2']&quot;</span><span class="token punctuation">,</span> xmlns<span class="token punctuation">)</span><span class="token punctuation">;</span>
Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>title<span class="token punctuation">.</span>InnerText<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Franklin2</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="读取xml相同节点相同属性的值"><a href="#读取xml相同节点相同属性的值" class="header-anchor">#</a> 读取xml相同节点相同属性的值</h3> <p>20230928.xml文件：</p> <p>获取CT检查单这个值。<methodCode></methodCode>节点数量1~n个。</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>QUMT_IN020040UV01</span> <span class="token attr-name">ITSVersion</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>XML_1.0<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span> urn:hl7-org:v3 ../multicacheschemas/QUMT_IN020040UV01YZ.xsd<span class="token punctuation">&quot;</span></span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>urn:hl7-org:v3<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>methodCode</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span> <span class="token attr-name">code</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">codeSystem</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2.16.156.10011.2.3.2.47<span class="token punctuation">&quot;</span></span> <span class="token attr-name">codeSystemName</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>检查方式代码表<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>displayName</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>item</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span> <span class="token attr-name">code</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>00046<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>displayName</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>CT检查单<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>item</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>methodCode</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>methodCode</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span> <span class="token attr-name">code</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">codeSystem</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2.16.156.10011.2.3.2.47<span class="token punctuation">&quot;</span></span> <span class="token attr-name">codeSystemName</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>检查方式代码表<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>displayName</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>item</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span> <span class="token attr-name">code</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>00046<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>displayName</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>DX检查单<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>item</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>methodCode</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>methodCode</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span> <span class="token attr-name">code</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">codeSystem</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2.16.156.10011.2.3.2.47<span class="token punctuation">&quot;</span></span> <span class="token attr-name">codeSystemName</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>检查方式代码表<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>displayName</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>item</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span> <span class="token attr-name">code</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>00046<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>displayName</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>MR检查单<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>item</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>methodCode</span><span class="token punctuation">&gt;</span></span> 
  <span class="token comment">&lt;!--&lt;methodCode&gt;...&lt;/methodCode&gt;--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>QUMT_IN020040UV01</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>代码读取：</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token class-name">System<span class="token punctuation">.</span>Xml<span class="token punctuation">.</span>XmlDocument</span> xmlDocument <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Xml<span class="token punctuation">.</span>XmlDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xmlDocument<span class="token punctuation">.</span><span class="token function">Load</span><span class="token punctuation">(</span><span class="token string">@&quot;C:\Users\Administrator\Desktop\20230928.xml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System<span class="token punctuation">.</span>Xml<span class="token punctuation">.</span>XmlNamespaceManager</span> xmlNamespaceManager <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Xml<span class="token punctuation">.</span>XmlNamespaceManager</span><span class="token punctuation">(</span>xmlDocument<span class="token punctuation">.</span>NameTable<span class="token punctuation">)</span><span class="token punctuation">;</span>
xmlNamespaceManager<span class="token punctuation">.</span><span class="token function">AddNamespace</span><span class="token punctuation">(</span><span class="token string">&quot;ns&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;urn:hl7-org:v3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">XmlNode</span> methodCode <span class="token operator">=</span> xmlDocument<span class="token punctuation">.</span><span class="token function">SelectSingleNode</span><span class="token punctuation">(</span><span class="token string">&quot;//ns:QUMT_IN020040UV01//ns:methodCode&quot;</span><span class="token punctuation">,</span> xmlNamespaceManager<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">string</span></span> displayName <span class="token operator">=</span> methodCode<span class="token punctuation">.</span>ChildNodes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">SelectSingleNode</span><span class="token punctuation">(</span><span class="token string">&quot;ns:displayName&quot;</span><span class="token punctuation">,</span> xmlNamespaceManager<span class="token punctuation">)</span><span class="token punctuation">.</span>Attributes<span class="token punctuation">[</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>displayName<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// CT检查单</span>

<span class="token comment">// 获取所有的displayName的值</span>
<span class="token class-name">XmlNode</span> xmlNode <span class="token operator">=</span> xmlDocument<span class="token punctuation">.</span><span class="token function">SelectSingleNode</span><span class="token punctuation">(</span><span class="token string">&quot;//ns:QUMT_IN020040UV01&quot;</span><span class="token punctuation">,</span> xmlNamespaceManager<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name">XmlNode</span> childNode <span class="token keyword">in</span> xmlNode<span class="token punctuation">.</span>ChildNodes<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>childNode<span class="token punctuation">.</span>Name<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token string">&quot;methodCode&quot;</span><span class="token punctuation">:</span>
            displayName <span class="token operator">=</span> childNode<span class="token punctuation">.</span>ChildNodes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ChildNodes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Attributes<span class="token punctuation">[</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            displayName <span class="token operator">=</span> childNode<span class="token punctuation">.</span>ChildNodes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">SelectSingleNode</span><span class="token punctuation">(</span><span class="token string">&quot;ns:displayName&quot;</span><span class="token punctuation">,</span> xmlNamespaceManager<span class="token punctuation">)</span><span class="token punctuation">.</span>Attributes<span class="token punctuation">[</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>displayName<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// CT检查单  DX检查单  MR检查单</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>

        <span class="token keyword">default</span><span class="token punctuation">:</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h3 id="app-manifest"><a href="#app-manifest" class="header-anchor">#</a> app.manifest</h3> <p>添加新项，选择应用程序清单文件。</p> <p><img src="/vuepress/assets/img/image-20230814113003956.ad3e5b27.png" alt="image-20230814113003956"></p> <h3 id="cpu使用率"><a href="#cpu使用率" class="header-anchor">#</a> cpu使用率</h3> <p>1.创建.net framework2.0控制台项目。添加引用，选择程序集，选择System.Management然后点确定。</p> <p>新建一个SystemInfo.cs类</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">namespace</span> <span class="token namespace">TestConsoleApp</span>
<span class="token punctuation">{</span>
    <span class="token keyword">class</span> <span class="token class-name">SystemInfo</span>
    <span class="token punctuation">{</span>
        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// CPU计数器</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token keyword">private</span> <span class="token class-name">System<span class="token punctuation">.</span>Diagnostics<span class="token punctuation">.</span>PerformanceCounter</span> cpuUsage<span class="token punctuation">;</span>   <span class="token comment">// CPU计数器</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">float</span></span> CpuUsage <span class="token punctuation">{</span> <span class="token keyword">get</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> cpuUsage<span class="token punctuation">.</span><span class="token function">NextValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token function">SystemInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            cpuUsage <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Diagnostics<span class="token punctuation">.</span>PerformanceCounter</span><span class="token punctuation">(</span><span class="token string">&quot;Processor&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;% Processor Time&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;_Total&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            cpuUsage<span class="token punctuation">.</span>MachineName <span class="token operator">=</span> <span class="token string">&quot;.&quot;</span><span class="token punctuation">;</span>
            cpuUsage<span class="token punctuation">.</span><span class="token function">NextValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            System<span class="token punctuation">.</span>Threading<span class="token punctuation">.</span>Thread<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>获取cpu使用率：</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code>Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;Hello World!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name"><span class="token keyword">var</span></span> cpu <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SystemInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>CpuUsage<span class="token punctuation">;</span>
Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;SystemInfo cpu使用率：&quot;</span> <span class="token operator">+</span> cpu<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// SystemInfo cpu使用率：26.88997</span>

Console<span class="token punctuation">.</span><span class="token function">ReadKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="cpu逻辑处理器数"><a href="#cpu逻辑处理器数" class="header-anchor">#</a> cpu逻辑处理器数</h3> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code>Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;cpu逻辑处理器数：&quot;</span> <span class="token operator">+</span> Environment<span class="token punctuation">.</span>ProcessorCount<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// cpu处理器数：12</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="ram大小"><a href="#ram大小" class="header-anchor">#</a> ram大小</h3> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token class-name"><span class="token keyword">var</span></span> ram <span class="token operator">=</span> <span class="token number">0L</span><span class="token punctuation">;</span>
<span class="token class-name">System<span class="token punctuation">.</span>Management<span class="token punctuation">.</span>ManagementClass</span> managementClass <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Management<span class="token punctuation">.</span>ManagementClass</span><span class="token punctuation">(</span><span class="token string">&quot;Win32_ComputerSystem&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System<span class="token punctuation">.</span>Management<span class="token punctuation">.</span>ManagementObjectCollection</span> managements <span class="token operator">=</span> managementClass<span class="token punctuation">.</span><span class="token function">GetInstances</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name">System<span class="token punctuation">.</span>Management<span class="token punctuation">.</span>ManagementObject</span> management <span class="token keyword">in</span> managements<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>management<span class="token punctuation">[</span><span class="token string">&quot;TotalPhysicalMemory&quot;</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        ram <span class="token operator">=</span> <span class="token keyword">long</span><span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span>management<span class="token punctuation">[</span><span class="token string">&quot;TotalPhysicalMemory&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;内存：&quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>ram <span class="token operator">*</span> <span class="token number">1.00</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token string">&quot;F2&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;GB&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 内存：15.75GB</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="ram可用大小"><a href="#ram可用大小" class="header-anchor">#</a> ram可用大小</h3> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token class-name"><span class="token keyword">long</span></span> availableRam <span class="token operator">=</span> <span class="token number">0L</span><span class="token punctuation">;</span>
<span class="token class-name">System<span class="token punctuation">.</span>Management<span class="token punctuation">.</span>ManagementClass</span> mos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Management<span class="token punctuation">.</span>ManagementClass</span><span class="token punctuation">(</span><span class="token string">&quot;Win32_OperatingSystem&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name">System<span class="token punctuation">.</span>Management<span class="token punctuation">.</span>ManagementObject</span> mo <span class="token keyword">in</span> mos<span class="token punctuation">.</span><span class="token function">GetInstances</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>mo<span class="token punctuation">[</span><span class="token string">&quot;FreePhysicalMemory&quot;</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        availableRam <span class="token operator">=</span> <span class="token keyword">long</span><span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span>mo<span class="token punctuation">[</span><span class="token string">&quot;FreePhysicalMemory&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;可用内存：&quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>availableRam <span class="token operator">*</span> <span class="token number">1.00</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token string">&quot;F2&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;GB&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 可用内存：2.68GB</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="ram已用大小"><a href="#ram已用大小" class="header-anchor">#</a> ram已用大小</h3> <p>ram大小 - ram可用大小 = ram已用大小</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code>Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;已用内存：&quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>ram <span class="token operator">*</span> <span class="token number">1.00</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">-</span> availableRam <span class="token operator">*</span> <span class="token number">1.00</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token string">&quot;F2&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;GB&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 已用内存：13.07GB</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="硬盘信息"><a href="#硬盘信息" class="header-anchor">#</a> 硬盘信息</h3> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token comment">// 获取硬盘信息</span>
<span class="token class-name">System<span class="token punctuation">.</span>IO<span class="token punctuation">.</span>DriveInfo<span class="token punctuation">[</span><span class="token punctuation">]</span></span> drive <span class="token operator">=</span> System<span class="token punctuation">.</span>IO<span class="token punctuation">.</span>DriveInfo<span class="token punctuation">.</span><span class="token function">GetDrives</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 获取所有驱动器</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> drive<span class="token punctuation">.</span>Length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token comment">// 遍历驱动器</span>
<span class="token punctuation">{</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>drive<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// C:\</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>drive<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>DriveFormat<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// NTFS</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;总空间：&quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>drive<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>TotalSize <span class="token operator">*</span> <span class="token number">1.00</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token string">&quot;F2&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;GB&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 总空间：300.00GB</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;剩余空间：&quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>drive<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>TotalFreeSpace <span class="token operator">*</span> <span class="token number">1.00</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token string">&quot;F2&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;GB&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 剩余空间：72.50GB</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;已用空间：&quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>drive<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>TotalSize <span class="token operator">-</span> drive<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>TotalFreeSpace<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1.00</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token string">&quot;F2&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;GB&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 已用空间：227.50GB</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="本地ip地址"><a href="#本地ip地址" class="header-anchor">#</a> 本地ip地址</h3> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token class-name">System<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>IPHostEntry</span> ipEntry <span class="token operator">=</span> System<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>Dns<span class="token punctuation">.</span><span class="token function">GetHostEntry</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>Dns<span class="token punctuation">.</span><span class="token function">GetHostName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;主机名：&quot;</span> <span class="token operator">+</span> ipEntry<span class="token punctuation">.</span>HostName<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 主机名：USER-20221130QZ</span>
<span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> ip <span class="token keyword">in</span> ipEntry<span class="token punctuation">.</span>AddressList<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;IP Address: &quot;</span> <span class="token operator">+</span> ip<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// IP Address: 192.168.62.125</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="网卡mac地址"><a href="#网卡mac地址" class="header-anchor">#</a> 网卡mac地址</h3> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name">System<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>NetworkInformation<span class="token punctuation">.</span>NetworkInterface</span> nic <span class="token keyword">in</span> System<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>NetworkInformation<span class="token punctuation">.</span>NetworkInterface<span class="token punctuation">.</span><span class="token function">GetAllNetworkInterfaces</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword">string</span></span> macAddress<span class="token punctuation">;</span>
    <span class="token comment">// 网络接口已打开，可以传输数据</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>nic<span class="token punctuation">.</span>OperationalStatus <span class="token operator">==</span> System<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>NetworkInformation<span class="token punctuation">.</span>OperationalStatus<span class="token punctuation">.</span>Up<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        macAddress <span class="token operator">=</span> nic<span class="token punctuation">.</span><span class="token function">GetPhysicalAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>macAddress<span class="token punctuation">.</span>Length <span class="token operator">&gt;</span> <span class="token number">11</span><span class="token punctuation">)</span>
            macAddress <span class="token operator">=</span> macAddress<span class="token punctuation">.</span><span class="token function">Insert</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Insert</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">&quot;:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Insert</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">&quot;:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Insert</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token string">&quot;:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Insert</span><span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">,</span> <span class="token string">&quot;:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;UP:  &quot;</span> <span class="token operator">+</span> macAddress<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// UP:  B4:45:06:88:2C:62</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 网络接口无法传输数据</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>nic<span class="token punctuation">.</span>OperationalStatus <span class="token operator">==</span> System<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>NetworkInformation<span class="token punctuation">.</span>OperationalStatus<span class="token punctuation">.</span>Down<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        macAddress <span class="token operator">=</span> nic<span class="token punctuation">.</span><span class="token function">GetPhysicalAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>macAddress<span class="token punctuation">.</span>Length <span class="token operator">&gt;</span> <span class="token number">11</span><span class="token punctuation">)</span>
            macAddress <span class="token operator">=</span> macAddress<span class="token punctuation">.</span><span class="token function">Insert</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Insert</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">&quot;:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Insert</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">&quot;:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Insert</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token string">&quot;:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Insert</span><span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">,</span> <span class="token string">&quot;:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;Down:&quot;</span> <span class="token operator">+</span> macAddress<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Down:1E:C1:0C:C0:6D:9F</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="根据生日计算年龄"><a href="#根据生日计算年龄" class="header-anchor">#</a> 根据生日计算年龄</h3> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// 从生日计算年龄</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token comment">/// &lt;param name=&quot;birthday&quot;&gt;生日&lt;/param&gt;</span>
<span class="token comment">/// &lt;param name=&quot;ageType&quot;&gt;年龄单位&lt;/param&gt;</span>
<span class="token comment">/// &lt;returns&gt;&lt;/returns&gt;</span>
<span class="token return-type class-name"><span class="token keyword">int</span></span> <span class="token function">f_ConvertBirthdayToAge</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> birthday<span class="token punctuation">,</span><span class="token class-name"><span class="token keyword">string</span></span> ageType<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">try</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">DateTime</span> date <span class="token operator">=</span> Convert<span class="token punctuation">.</span><span class="token function">ToDateTime</span><span class="token punctuation">(</span>txt_dbirthday<span class="token punctuation">.</span>Text<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword">int</span></span> age <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span>ageType<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>

            <span class="token keyword">case</span> <span class="token string">&quot;月&quot;</span><span class="token punctuation">:</span>
                <span class="token punctuation">{</span>
                    age <span class="token operator">=</span> DateTime<span class="token punctuation">.</span>Now<span class="token punctuation">.</span>Year <span class="token operator">-</span> date<span class="token punctuation">.</span>Year<span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>DateTime<span class="token punctuation">.</span>Now<span class="token punctuation">.</span>Month <span class="token operator">&lt;</span> date<span class="token punctuation">.</span>Month<span class="token punctuation">)</span>
                    <span class="token punctuation">{</span>
                        age<span class="token operator">--</span><span class="token punctuation">;</span>
                        age <span class="token operator">=</span> age <span class="token operator">*</span> <span class="token number">12</span> <span class="token operator">+</span> date<span class="token punctuation">.</span>Month <span class="token operator">-</span> DateTime<span class="token punctuation">.</span>Now<span class="token punctuation">.</span>Month<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">else</span>
                    <span class="token punctuation">{</span>
                        age <span class="token operator">=</span> age <span class="token operator">*</span> <span class="token number">12</span> <span class="token operator">+</span> DateTime<span class="token punctuation">.</span>Now<span class="token punctuation">.</span>Month <span class="token operator">-</span> date<span class="token punctuation">.</span>Month<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token keyword">case</span> <span class="token string">&quot;天&quot;</span><span class="token punctuation">:</span>
                <span class="token punctuation">{</span>
                    age <span class="token operator">=</span> <span class="token punctuation">(</span>DateTime<span class="token punctuation">.</span>Now <span class="token operator">-</span> date<span class="token punctuation">)</span><span class="token punctuation">.</span>Days<span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token keyword">case</span> <span class="token string">&quot;小时&quot;</span><span class="token punctuation">:</span>
                <span class="token punctuation">{</span>
                    age <span class="token operator">=</span> <span class="token punctuation">(</span>DateTime<span class="token punctuation">.</span>Now <span class="token operator">-</span> date<span class="token punctuation">)</span><span class="token punctuation">.</span>Hours<span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token keyword">case</span> <span class="token string">&quot;分&quot;</span><span class="token punctuation">:</span>
                <span class="token punctuation">{</span>
                    age <span class="token operator">=</span> <span class="token punctuation">(</span>DateTime<span class="token punctuation">.</span>Now <span class="token operator">-</span> date<span class="token punctuation">)</span><span class="token punctuation">.</span>Minutes<span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token keyword">case</span> <span class="token string">&quot;岁&quot;</span><span class="token punctuation">:</span>

            <span class="token keyword">default</span><span class="token punctuation">:</span>
                <span class="token punctuation">{</span>
                    age <span class="token operator">=</span> DateTime<span class="token punctuation">.</span>Now<span class="token punctuation">.</span>Year <span class="token operator">-</span> date<span class="token punctuation">.</span>Year<span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>DateTime<span class="token punctuation">.</span>Now<span class="token punctuation">.</span>Month <span class="token operator">&lt;</span> date<span class="token punctuation">.</span>Month<span class="token punctuation">)</span> age<span class="token operator">--</span><span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>age <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> age <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> age<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        logHelper<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;f_ConvertBirthdayToAge方法中，生日不正确:&quot;</span> <span class="token operator">+</span> txt_dbirthday<span class="token punctuation">.</span>Text <span class="token operator">+</span> <span class="token string">&quot;;ex:&quot;</span> <span class="token operator">+</span> ex<span class="token punctuation">.</span>Message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br></div></div><h3 id="把字符串转为日期类型"><a href="#把字符串转为日期类型" class="header-anchor">#</a> 把字符串转为日期类型</h3> <p>把字符串20230928转换成DateTime类型，然后输出指定的日期格式。</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token class-name"><span class="token keyword">string</span></span> birthday <span class="token operator">=</span> DateTime<span class="token punctuation">.</span><span class="token function">ParseExact</span><span class="token punctuation">(</span><span class="token string">&quot;20230928&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;yyyyMMdd&quot;</span><span class="token punctuation">,</span> System<span class="token punctuation">.</span>Globalization<span class="token punctuation">.</span>CultureInfo<span class="token punctuation">.</span>CurrentCulture<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>birthday<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2023-09-28 00:00:00</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="datatable添加一行数据"><a href="#datatable添加一行数据" class="header-anchor">#</a> DataTable添加一行数据</h3> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token class-name">DataTable</span> dataTable <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">DataTable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
dataTable<span class="token punctuation">.</span>TableName <span class="token operator">=</span> <span class="token string">&quot;userinfo&quot;</span><span class="token punctuation">;</span>

<span class="token class-name">System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>DataColumn</span> id <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">DataColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
id<span class="token punctuation">.</span>ColumnName <span class="token operator">=</span> <span class="token string">&quot;id&quot;</span><span class="token punctuation">;</span>
id<span class="token punctuation">.</span>DataType <span class="token operator">=</span> System<span class="token punctuation">.</span>Type<span class="token punctuation">.</span><span class="token function">GetType</span><span class="token punctuation">(</span><span class="token string">&quot;System.Int64&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
id<span class="token punctuation">.</span>AllowDBNull <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// 不允许为DBNull值(不存在的值)</span>
id<span class="token punctuation">.</span>Unique <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// 值约束为唯一</span>
id<span class="token punctuation">.</span>AutoIncrement <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// 添加新行时自动递增</span>
id<span class="token punctuation">.</span>AutoIncrementSeed <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// 从1开始递增，第一行的id为1</span>
id<span class="token punctuation">.</span>AutoIncrementStep <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// 递增步长为1</span>
dataTable<span class="token punctuation">.</span>Columns<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
dataTable<span class="token punctuation">.</span>PrimaryKey <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">DataColumn<span class="token punctuation">[</span><span class="token punctuation">]</span></span> <span class="token punctuation">{</span> dataTable<span class="token punctuation">.</span>Columns<span class="token punctuation">[</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token class-name">System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>DataColumn</span> check <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">DataColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
check<span class="token punctuation">.</span>DefaultValue <span class="token operator">=</span> <span class="token string">&quot;false&quot;</span><span class="token punctuation">;</span>
check<span class="token punctuation">.</span>ColumnName <span class="token operator">=</span> <span class="token string">&quot;check&quot;</span><span class="token punctuation">;</span>
check<span class="token punctuation">.</span>DataType <span class="token operator">=</span> System<span class="token punctuation">.</span>Type<span class="token punctuation">.</span><span class="token function">GetType</span><span class="token punctuation">(</span><span class="token string">&quot;System.Boolean&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
dataTable<span class="token punctuation">.</span>Columns<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>check<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>DataColumn</span> name <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">DataColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
name<span class="token punctuation">.</span>DefaultValue <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
name<span class="token punctuation">.</span>ColumnName <span class="token operator">=</span> <span class="token string">&quot;name&quot;</span><span class="token punctuation">;</span>
name<span class="token punctuation">.</span>DataType <span class="token operator">=</span> System<span class="token punctuation">.</span>Type<span class="token punctuation">.</span><span class="token function">GetType</span><span class="token punctuation">(</span><span class="token string">&quot;System.String&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
name<span class="token punctuation">.</span>AllowDBNull <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// 不允许为DBNull值(不存在的值)</span>
name<span class="token punctuation">.</span>Unique <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// 值约束为唯一</span>

dataTable<span class="token punctuation">.</span>Columns<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>DataColumn</span> age <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">DataColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
age<span class="token punctuation">.</span>DefaultValue <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
age<span class="token punctuation">.</span>ColumnName <span class="token operator">=</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">;</span>
age<span class="token punctuation">.</span>DataType <span class="token operator">=</span> System<span class="token punctuation">.</span>Type<span class="token punctuation">.</span><span class="token function">GetType</span><span class="token punctuation">(</span><span class="token string">&quot;System.Int32&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
dataTable<span class="token punctuation">.</span>Columns<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>DataColumn</span> day <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">DataColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
day<span class="token punctuation">.</span>DefaultValue <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
day<span class="token punctuation">.</span>ColumnName <span class="token operator">=</span> <span class="token string">&quot;day&quot;</span><span class="token punctuation">;</span>
day<span class="token punctuation">.</span>DataType <span class="token operator">=</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name"><span class="token keyword">int</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 表达式：“总计 &gt;= 500”；&quot;UnitPrice * Quantity&quot;；Sum(Price)</span>
day<span class="token punctuation">.</span>Expression <span class="token operator">=</span> <span class="token string">&quot;365 * age&quot;</span><span class="token punctuation">;</span> <span class="token comment">// 设置表达式计算该列的值</span>
dataTable<span class="token punctuation">.</span>Columns<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>day<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">DataRow</span> dataRow <span class="token operator">=</span> dataTable<span class="token punctuation">.</span><span class="token function">NewRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
dataRow<span class="token punctuation">[</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;张三&quot;</span><span class="token punctuation">;</span>
dataRow<span class="token punctuation">[</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
dataTable<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>dataRow<span class="token punctuation">)</span><span class="token punctuation">;</span>

dataRow <span class="token operator">=</span> dataTable<span class="token punctuation">.</span><span class="token function">NewRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
dataRow<span class="token punctuation">[</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;李四&quot;</span><span class="token punctuation">;</span>
dataRow<span class="token punctuation">[</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">99</span><span class="token punctuation">;</span>
dataTable<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>dataRow<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">DataRow</span> dataRow1 <span class="token operator">=</span> dataTable<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// DataRow：表中包含的实际数据</span>

<span class="token class-name">DataSet</span> dataSet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">DataSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
dataSet<span class="token punctuation">.</span>Tables<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>dataTable<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br></div></div><h3 id="other"><a href="#other" class="header-anchor">#</a> Other</h3> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token comment">//打开图片</span>
<span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">button1_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    openFileDialog1<span class="token punctuation">.</span>Filter <span class="token operator">=</span> <span class="token string">&quot;jpg,bmp,gif|*.jpg;*.gif;*.bmp&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>openFileDialog1<span class="token punctuation">.</span><span class="token function">ShowDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> DialogResult<span class="token punctuation">.</span>OK<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        pictureBox1<span class="token punctuation">.</span>ImageLocation <span class="token operator">=</span> openFileDialog1<span class="token punctuation">.</span>FileName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//打开加密文件</span>
<span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">button2_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    openFileDialog1<span class="token punctuation">.</span>Filter <span class="token operator">=</span> <span class="token string">&quot;文本文件|*.txt&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>openFileDialog1<span class="token punctuation">.</span><span class="token function">ShowDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> DialogResult<span class="token punctuation">.</span>OK<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        textBox1<span class="token punctuation">.</span>Text <span class="token operator">=</span> openFileDialog1<span class="token punctuation">.</span>FileName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 加密</span>
<span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">button3_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">try</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>pictureBox1<span class="token punctuation">.</span>ImageLocation <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span> MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">&quot;请选择一幅图片用于加密&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>textBox1<span class="token punctuation">.</span>Text <span class="token operator">==</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span> MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">&quot;请选择加密文件路径&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
        <span class="token comment">//图片流</span>
        <span class="token class-name">FileStream</span> fsPic <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">FileStream</span><span class="token punctuation">(</span>pictureBox1<span class="token punctuation">.</span>ImageLocation<span class="token punctuation">,</span> FileMode<span class="token punctuation">.</span>Open<span class="token punctuation">,</span> FileAccess<span class="token punctuation">.</span>Read<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//加密文件流</span>
        <span class="token class-name">FileStream</span> fsText <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">FileStream</span><span class="token punctuation">(</span>textBox1<span class="token punctuation">.</span>Text<span class="token punctuation">,</span> FileMode<span class="token punctuation">.</span>Open<span class="token punctuation">,</span> FileAccess<span class="token punctuation">.</span>Read<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//初始化Key IV</span>
        <span class="token class-name"><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> bykey <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">byte</span></span><span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> byIv <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">byte</span></span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        fsPic<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span>bykey<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        fsPic<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span>byIv<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//临时加密文件</span>
        <span class="token class-name"><span class="token keyword">string</span></span> strPath <span class="token operator">=</span> textBox1<span class="token punctuation">.</span>Text<span class="token punctuation">;</span><span class="token comment">//加密文件的路径</span>
        <span class="token class-name"><span class="token keyword">int</span></span> intLent <span class="token operator">=</span> strPath<span class="token punctuation">.</span><span class="token function">LastIndexOf</span><span class="token punctuation">(</span><span class="token string">&quot;\\&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword">int</span></span> intLong <span class="token operator">=</span> strPath<span class="token punctuation">.</span>Length<span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword">string</span></span> strName <span class="token operator">=</span> strPath<span class="token punctuation">.</span><span class="token function">Substring</span><span class="token punctuation">(</span>intLent<span class="token punctuation">,</span> intLong <span class="token operator">-</span> intLent<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//要加密的文件名称</span>
        <span class="token class-name"><span class="token keyword">string</span></span> strLinPath <span class="token operator">=</span> <span class="token string">&quot;C:\\&quot;</span> <span class="token operator">+</span> strName<span class="token punctuation">;</span><span class="token comment">//临时加密文件路径，所以被加密的文件不可以放在C盘的根目录下</span>
        <span class="token class-name">FileStream</span> fsOut <span class="token operator">=</span> File<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span>strLinPath<span class="token punctuation">,</span> FileMode<span class="token punctuation">.</span>Create<span class="token punctuation">,</span> FileAccess<span class="token punctuation">.</span>Write<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//开始加密</span>
        <span class="token class-name">RC2CryptoServiceProvider</span> desc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">RC2CryptoServiceProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//des进行加</span>
        <span class="token class-name">BinaryReader</span> br <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">BinaryReader</span><span class="token punctuation">(</span>fsText<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//从要加密的文件中读出文件内容</span>
        <span class="token class-name">CryptoStream</span> cs <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">CryptoStream</span><span class="token punctuation">(</span>fsOut<span class="token punctuation">,</span> desc<span class="token punctuation">.</span><span class="token function">CreateEncryptor</span><span class="token punctuation">(</span>bykey<span class="token punctuation">,</span> byIv<span class="token punctuation">)</span><span class="token punctuation">,</span> CryptoStreamMode<span class="token punctuation">.</span>Write<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//写入临时加密文件</span>
        cs<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>br<span class="token punctuation">.</span><span class="token function">ReadBytes</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>fsText<span class="token punctuation">.</span>Length<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>fsText<span class="token punctuation">.</span>Length<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//写入加密流</span>
        cs<span class="token punctuation">.</span><span class="token function">FlushFinalBlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        cs<span class="token punctuation">.</span><span class="token function">Flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        cs<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        fsPic<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        fsText<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        fsOut<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        File<span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span>textBox1<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">TrimEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//册除原文件</span>
        File<span class="token punctuation">.</span><span class="token function">Copy</span><span class="token punctuation">(</span>strLinPath<span class="token punctuation">,</span> textBox1<span class="token punctuation">.</span>Text<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//复制加密文件</span>
        File<span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span>strLinPath<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//册除临时文件</span>
        MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">&quot;加密成功&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        pictureBox1<span class="token punctuation">.</span>ImageLocation <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        textBox1<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ee<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span>ee<span class="token punctuation">.</span>Message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

<span class="token comment">//解密</span>
<span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">button4_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">try</span>
    <span class="token punctuation">{</span>
        <span class="token comment">//图片流</span>
        <span class="token class-name">FileStream</span> fsPic <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">FileStream</span><span class="token punctuation">(</span>pictureBox1<span class="token punctuation">.</span>ImageLocation<span class="token punctuation">,</span> FileMode<span class="token punctuation">.</span>Open<span class="token punctuation">,</span> FileAccess<span class="token punctuation">.</span>Read<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//解密文件流</span>
        <span class="token class-name">FileStream</span> fsOut <span class="token operator">=</span> File<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span>textBox1<span class="token punctuation">.</span>Text<span class="token punctuation">,</span> FileMode<span class="token punctuation">.</span>Open<span class="token punctuation">,</span> FileAccess<span class="token punctuation">.</span>Read<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//初始化Key IV</span>
        <span class="token class-name"><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> bykey <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">byte</span></span><span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> byIv <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">byte</span></span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        fsPic<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span>bykey<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        fsPic<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span>byIv<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//临时解密文件</span>
        <span class="token class-name"><span class="token keyword">string</span></span> strPath <span class="token operator">=</span> textBox1<span class="token punctuation">.</span>Text<span class="token punctuation">;</span><span class="token comment">//加密文件的路径</span>
        <span class="token class-name"><span class="token keyword">int</span></span> intLent <span class="token operator">=</span> strPath<span class="token punctuation">.</span><span class="token function">LastIndexOf</span><span class="token punctuation">(</span><span class="token string">&quot;\\&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword">int</span></span> intLong <span class="token operator">=</span> strPath<span class="token punctuation">.</span>Length<span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword">string</span></span> strName <span class="token operator">=</span> strPath<span class="token punctuation">.</span><span class="token function">Substring</span><span class="token punctuation">(</span>intLent<span class="token punctuation">,</span> intLong <span class="token operator">-</span> intLent<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//要加密的文件名称</span>
        <span class="token class-name"><span class="token keyword">string</span></span> strLinPath <span class="token operator">=</span> <span class="token string">&quot;C:\\&quot;</span> <span class="token operator">+</span> strName<span class="token punctuation">;</span><span class="token comment">//临时解密文件路径</span>
        <span class="token class-name">FileStream</span> fs <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">FileStream</span><span class="token punctuation">(</span>strLinPath<span class="token punctuation">,</span> FileMode<span class="token punctuation">.</span>Create<span class="token punctuation">,</span> FileAccess<span class="token punctuation">.</span>Write<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//开始解密</span>
        <span class="token class-name">RC2CryptoServiceProvider</span> desc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">RC2CryptoServiceProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//des进行解</span>
        <span class="token class-name">CryptoStream</span> csDecrypt <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">CryptoStream</span><span class="token punctuation">(</span>fsOut<span class="token punctuation">,</span> desc<span class="token punctuation">.</span><span class="token function">CreateDecryptor</span><span class="token punctuation">(</span>bykey<span class="token punctuation">,</span> byIv<span class="token punctuation">)</span><span class="token punctuation">,</span> CryptoStreamMode<span class="token punctuation">.</span>Read<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//读出加密文件</span>
        <span class="token class-name">BinaryReader</span> sr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">BinaryReader</span><span class="token punctuation">(</span>csDecrypt<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//从要加密流中读出文件内容</span>
        <span class="token class-name">BinaryWriter</span> sw <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">BinaryWriter</span><span class="token punctuation">(</span>fs<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//写入解密流</span>
        sw<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>sr<span class="token punctuation">.</span><span class="token function">ReadBytes</span><span class="token punctuation">(</span>Convert<span class="token punctuation">.</span><span class="token function">ToInt32</span><span class="token punctuation">(</span>fsOut<span class="token punctuation">.</span>Length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//</span>
        sw<span class="token punctuation">.</span><span class="token function">Flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sw<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sr<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        fs<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        fsOut<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        fsPic<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        csDecrypt<span class="token punctuation">.</span><span class="token function">Flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        File<span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span>textBox1<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">TrimEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//册除原文件</span>
        File<span class="token punctuation">.</span><span class="token function">Copy</span><span class="token punctuation">(</span>strLinPath<span class="token punctuation">,</span> textBox1<span class="token punctuation">.</span>Text<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//复制加密文件</span>
        File<span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span>strLinPath<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//册除临时文件</span>
        MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">&quot;解密成功&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        pictureBox1<span class="token punctuation">.</span>ImageLocation <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        textBox1<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ee<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span>ee<span class="token punctuation">.</span>Message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br></div></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/zichenlbl/vuepress/edit/master/docs/other/csharp/README.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">5/10/2024, 10:18:59 PM</span></div></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/vuepress/assets/js/app.4f476e97.js" defer></script><script src="/vuepress/assets/js/4.324cc9ea.js" defer></script><script src="/vuepress/assets/js/14.0d54ffe1.js" defer></script>
  </body>
</html>
